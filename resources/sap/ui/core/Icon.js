/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/assert","../Device","./Control","./_IconRegistry","./InvisibleText","./library","./IconRenderer","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery","sap/base/Log"],function(e,t,o,r,i,s,n,a,l,u){"use strict";var p=s.IconColor;var c=s.CSSColor;var h=function(e){if(e!=null&&e!==""&&!c.isValid(e)&&!(e in p)){u.error('"'+e+'" is not of type sap.ui.core.CSSColor nor of type sap.ui.core.IconColor.');return false}else{return true}};var d=o.extend("sap.ui.core.Icon",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.core",designtime:"sap/ui/core/designtime/Icon.designtime",properties:{src:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},size:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},color:{type:"string",group:"Appearance",defaultValue:null},hoverColor:{type:"string",group:"Appearance",defaultValue:null},activeColor:{type:"string",group:"Appearance",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},backgroundColor:{type:"string",group:"Appearance",defaultValue:null},hoverBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},activeBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},decorative:{type:"boolean",group:"Accessibility",defaultValue:true},useIconTooltip:{type:"boolean",group:"Accessibility",defaultValue:true},alt:{type:"string",group:"Accessibility",defaultValue:null},noTabStop:{type:"boolean",group:"Accessibility",defaultValue:false}},aggregations:{_invisibleText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}},renderer:n});d.prototype[t.support.touch?"ontouchstart":"onmousedown"]=function(e){if(this.hasListeners("press")){e.setMarked()}var t=this.getActiveColor(),o=this.getActiveBackgroundColor(),r;if(t||o){if(!e.targetTouches||e.targetTouches&&e.targetTouches.length===1){r=this.$();r.addClass("sapUiIconActive");if(t){this._addColorClass(t,"color")}if(o){this._addColorClass(o,"background-color")}}}};d.prototype[t.support.touch?"ontouchend":"onmouseup"]=function(e){if(!e.targetTouches||e.targetTouches&&e.targetTouches.length===0){this.$().removeClass("sapUiIconActive");this._restoreColors(t.system.desktop?"hover":undefined)}};d.prototype.onmouseover=function(){var e=this.getHoverColor(),t=this.getHoverBackgroundColor();if(e){this._addColorClass(e,"color")}if(t){this._addColorClass(t,"background-color")}};d.prototype.onmouseout=function(){this._restoreColors()};d.prototype[t.support.touch&&!t.system.desktop?"ontap":"onclick"]=function(e){if(this.hasListeners("press")){e.setMarked()}this.firePress({})};d.prototype.onkeydown=function(e){if(e.which===a.SPACE||e.which===a.ENTER){e.preventDefault();var t=this.$(),o=this.getActiveColor(),r=this.getActiveBackgroundColor();t.addClass("sapUiIconActive");if(o){this._addColorClass(o,"color")}if(r){this._addColorClass(r,"background-color")}}};d.prototype.onkeyup=function(e){if(e.which===a.SPACE||e.which===a.ENTER){this.$().removeClass("sapUiIconActive");this._restoreColors();this.firePress({})}};d.prototype._restoreColors=function(e){var t,o;if(e==="hover"){t=this.getHoverColor();o=this.getHoverBackgroundColor()}t=t||this.getColor();o=o||this.getBackgroundColor();this._addColorClass(t||"","color");this._addColorClass(o||"","background-color")};d.prototype._addColorClass=function(e,t){var o=this.$(),r=this;var i="";if(t==="color"){i="sapUiIconColor"}else if(t==="background-color"){i="sapUiIconBGColor"}else{return}l.each(p,function(e,t){r.removeStyleClass(i+t)});if(e in p){o.css(t,"");this.addStyleClass(i+e)}else{o.css(t,e)}};d.prototype.setSrc=function(t){e(t==null||r.isIconURI(t),this+": Property 'src' (value: '"+t+"') should be a valid Icon URI (sap-icon://...)");return this.setProperty("src",t)};d.prototype.setColor=function(e){if(h(e)){this.setProperty("color",e,true);this._addColorClass(e,"color")}return this};d.prototype.setActiveColor=function(e){if(h(e)){this.setProperty("activeColor",e,true)}return this};d.prototype.setHoverColor=function(e){if(h(e)){this.setProperty("hoverColor",e,true)}return this};d.prototype.setBackgroundColor=function(e){if(h(e)){this.setProperty("backgroundColor",e,true);this._addColorClass(e,"background-color")}return this};d.prototype.setActiveBackgroundColor=function(e){if(h(e)){this.setProperty("activeBackgroundColor",e,true)}return this};d.prototype.setHoverBackgroundColor=function(e){if(h(e)){this.setProperty("hoverBackgroundColor",e,true)}return this};d.prototype.attachEvent=function(e){o.prototype.attachEvent.apply(this,arguments);if(e=="press"&&this.hasListeners("press")){this.invalidate()}return this};d.prototype.detachEvent=function(e){o.prototype.detachEvent.apply(this,arguments);if(e=="press"&&!this.hasListeners("press")){this.invalidate()}return this};d.prototype._getOutputTitle=function(e){var t=this.getTooltip_AsString(),o=this.getUseIconTooltip();if(t||o&&e&&e.text){return t||e.text}};d.prototype._getIconLabel=function(e){var t=this.getAlt(),o=this.getTooltip_AsString(),r=this.getUseIconTooltip(),i=t||o||r&&e&&(e.text||e.name);if(i){return i}};d.prototype._createInvisibleText=function(e){var t=this.getAggregation("_invisibleText");if(!t){t=new i(this.getId()+"-label",{text:e});this.setAggregation("_invisibleText",t,true)}else{t.setProperty("text",e,true)}return t};d.prototype._getAccessibilityAttributes=function(e){var t=this.getAriaLabelledBy(),o={},r=this._getIconLabel(e),i;if(this.getDecorative()){o.role="presentation";o.hidden="true"}else if(this.hasListeners("press")){o.role="button"}else{o.role="img"}if(t.length>0){if(r){i=this._createInvisibleText(r);t.push(i.getId())}o.labelledby=t.join(" ")}else if(r){o.label=r}return o};d.prototype.getAccessibilityInfo=function(){if(this.getDecorative()){return null}var e=this.hasListeners("press");var t=r.getIconInfo(this.getSrc(),undefined,"sync");return{role:e?"button":"img",type:sap.ui.getCore().getLibraryResourceBundle("sap.ui.core").getText(e?"ACC_CTR_TYPE_BUTTON":"ACC_CTR_TYPE_IMAGE"),description:this.getAlt()||this.getTooltip_AsString()||(t?t.text||t.name:""),focusable:e}};return d});