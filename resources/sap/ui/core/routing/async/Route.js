/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/Device","sap/base/Log","sap/base/util/extend","sap/ui/core/Component"],function(e,t,i,r){"use strict";return{_routeMatched:function(o,a,n){var s=this._oRouter,g,h,f,u,_=null,l=null,c,d,T,p,v=this;s._stopWaitingTitleChangedFromChild();s._oMatchedRoute=this;s._bMatchingProcessStarted=true;f=i({},s._oConfig,this._oConfig);h=s.getTargets();var C;if(h){C=h._getTitleTargetName(f.target,f.titleTarget);if(C&&s._oPreviousTitleChangedRoute!==this){s._bFireTitleChanged=true;if(s._oOwner&&s._oOwner._bRoutingPropagateTitle){var m=r.getOwnerComponentFor(s._oOwner);var w=m&&m.getRouter();if(w){w._waitForTitleChangedOn(s)}}}else{s._bFireTitleChanged=false}if(this._oConfig.target){p=h._alignTargetsInfo(this._oConfig.target);p.forEach(function(e){e.propagateTitle=e.hasOwnProperty("propagateTitle")?e.propagateTitle:s._oConfig.propagateTitle;e.routeRelevant=true})}}else{p=this._oConfig.target}if(!a||a===true){c=true;a=Promise.resolve()}if(this._oParent){a=this._oParent._routeMatched(o,a)}else if(this._oNestingParent){this._oNestingParent._routeMatched(o,a,this)}d=Object.assign({},o);d.routeConfig=f;u={name:f.name,arguments:o,config:f};if(n){u.nestedRoute=n}this.fireBeforeMatched(u);s.fireBeforeRouteMatched(u);if(this._oTarget){g=this._oTarget;g._updateOptions(this._convertToTargetOptions(f));a=g._place(a);if(this._oRouter._oTargetHandler&&this._oRouter._oTargetHandler._chainNavigation){T=a;a=this._oRouter._oTargetHandler._chainNavigation(function(){return T})}}else{if(e.browser.msie||e.browser.edge){T=a;a=new Promise(function(e,t){setTimeout(function(){if(s._oTargets){var i=s._oTargets._display(p,d,v._oConfig.titleTarget,T);i.then(e,t)}else{e()}},0)})}else{a=s._oTargets._display(p,d,this._oConfig.titleTarget,a)}}return a.then(function(e){s._bMatchingProcessStarted=false;var i,r,a;if(Array.isArray(e)){i=e;e=i[0]}e=e||{};_=e.view;l=e.control;u.view=_;u.targetControl=l;if(i){r=[];a=[];i.forEach(function(e){r.push(e.view);a.push(e.control)});u.views=r;u.targetControls=a}if(f.callback){f.callback(this,o,f,l,_)}this.fireEvent("matched",u);s.fireRouteMatched(u);if(c){t.info("The route named '"+f.name+"' did match with its pattern",this);this.fireEvent("patternMatched",u);s.fireRoutePatternMatched(u)}return e}.bind(this))}}});