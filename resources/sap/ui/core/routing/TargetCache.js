/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/EventProvider","sap/ui/core/routing/async/TargetCache","sap/ui/core/routing/sync/TargetCache","sap/base/assert","sap/base/Log"],function(e,t,o,n,r){"use strict";var i=e.extend("sap.ui.core.routing.TargetCache",{constructor:function(r){if(!r){r={}}this._oCache={view:{},component:{}};this._oComponent=r.component;if(this._oComponent){n(this._oComponent.isA("sap.ui.core.UIComponent"),this+" - the component passed to the constructor needs to be an instance of UIComponent")}e.apply(this,arguments);this.async=r.async;if(this.async===undefined){this.async=true}var i=this.async?t:o;for(var s in i){this[s]=i[s]}},metadata:{publicMethods:["get","set"]},get:function(e,t){var o;try{if(t==="Component"&&!this.async){r.error("sap.ui.core.routing.Target doesn't support loading component in synchronous mode, please switch routing to async");throw new Error("sap.ui.core.routing.Target doesn't support loading component in synchronous mode, please switch routing to async")}if(!e){r.error("the oOptions parameter of getObject is mandatory",this);throw new Error("the oOptions parameter of getObject is mandatory")}o=this._get(e,t)}catch(e){return Promise.reject(e)}if(o instanceof Promise){return o}else if(o.isA("sap.ui.core.mvc.View")){return o.loaded()}else{return Promise.resolve(o)}},set:function(e,t,o){var r;this._checkName(e,t);n(t==="View"||t==="Component","sType must be either 'View' or 'Component'");r=this._oCache[t.toLowerCase()][e];if(!r){r=this._oCache[t.toLowerCase()][e]={}}r[undefined]=o;return this},destroy:function(){e.prototype.destroy.apply(this);if(this.bIsDestroyed){return this}function t(e){if(e&&e.destroy){e.destroy()}}Object.keys(this._oCache).forEach(function(e){var o=this._oCache[e];Object.keys(o).forEach(function(e){var n=o[e];Object.keys(n).forEach(function(e){var o=n[e];if(o instanceof Promise){o.then(t)}else{t(o)}})})}.bind(this));this._oCache=undefined;this.bIsDestroyed=true;return this},attachCreated:function(e,t,o){return this.attachEvent("created",e,t,o)},detachCreated:function(e,t){return this.detachEvent("created",e,t)},fireCreated:function(e){return this.fireEvent("created",e)},_get:function(e,t,o,n){var r;switch(t){case"View":r=this._getView(e,o);break;case"Component":r=this._getComponent(e,o,n);break;default:throw Error("The given sType: "+t+" isn't supported by TargetCache.getObject")}return r},_getView:function(e,t){if(!t){e=this._createId(e)}return this._getViewWithGlobalId(e)},_getComponent:function(e,t,o){if(!t){e=this._createId(e)}return this._getComponentWithGlobalId(e,o)},_createId:function(e){if(this._oComponent&&e.id){e=Object.assign({},e,{id:this._oComponent.createId(e.id)})}return e},_checkName:function(e,t){if(!e){var o="A name for the "+t.toLowerCase()+" has to be defined";r.error(o,this);throw Error(o)}}});return i});