/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/ui/core/XMLCompositeMetadata","sap/ui/model/base/ManagedObjectModel","sap/ui/model/json/JSONModel","sap/ui/core/Fragment","sap/ui/base/ManagedObject","sap/ui/base/DataType","sap/ui/model/resource/ResourceModel","sap/base/Log","sap/ui/performance/Measurement"],function(e,t,i,r,o,n,a,s,g,p,d){"use strict";var u="sap.ui.core.XMLComposite";var l=t.extend("sap.ui.core.XMLComposite",{metadata:{interfaces:["sap.ui.core.IDScope"],properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%",invalidate:true},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null,invalidate:true},displayBlock:{type:"boolean",group:"Appearance",defaultValue:true,invalidate:true}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden",invalidate:true}}},constructor:function(){this._bIsCreating=true;t.apply(this,arguments);delete this._bIsCreating},renderer:function(e,t){p.debug("Start rendering '"+t.sId,u);d.start(t.getId()+"---renderControl","Rendering of "+t.getMetadata().getName(),["rendering","control"]);e.write("<div");e.writeControlData(t);e.writeAccessibilityState(t);if(!t.getDisplayBlock()&&(t.getWidth()!=="100%"||t.getHeight()!=="100%")){e.addStyle("display","inline-block")}e.writeClasses();if(t.getHeight()){e.addStyle("height",t.getHeight())}if(t.getWidth()){e.addStyle("width",t.getWidth())}e.writeStyles();e.write(">");var i=t._renderingContent?t._renderingContent():t._getCompositeAggregation();if(i){e.renderControl(i)}e.write("</div>");d.end(t.getId()+"---renderControl");p.debug("Stop rendering '"+t.sId,u)}},i);l.prototype.byId=function(e){return sap.ui.getCore().byId(n.createId(this.getId(),e))};l.prototype._getManagedObjectModel=function(){if(!this._oManagedObjectModel){this._oManagedObjectModel=new r(this)}return this._oManagedObjectModel};l.prototype.getSuppressInvalidateAggregation=function(e,t){var i=this.getMetadata(),r=i.getAggregation(e)||i.getAllPrivateAggregations()[e];if(!r){return true}t=i._suppressInvalidate(r,t);return t};l.prototype.setProperty=function(e,i,r){var o=this.getMetadata(),n=o.getProperty(e);if(!n){return this}r=this.getMetadata()._suppressInvalidate(n,r);return t.prototype.setProperty.apply(this,[e,i,r])};l.prototype.setAggregation=function(e,i,r){return t.prototype.setAggregation.apply(this,[e,i,this.getSuppressInvalidateAggregation(e,r)])};l.prototype.addAggregation=function(e,i,r){return t.prototype.addAggregation.apply(this,[e,i,this.getSuppressInvalidateAggregation(e,r)])};l.prototype.insertAggregation=function(e,i,r,o){return t.prototype.insertAggregation.apply(this,[e,i,r,this.getSuppressInvalidateAggregation(e,o)])};l.prototype.removeAggregation=function(e,i,r){return t.prototype.removeAggregation.apply(this,[e,i,this.getSuppressInvalidateAggregation(e,r)])};l.prototype.removeAllAggregation=function(e,i){return t.prototype.removeAllAggregation.apply(this,[e,this.getSuppressInvalidateAggregation(e,i)])};l.prototype.destroyAggregation=function(e,i){return t.prototype.destroyAggregation.apply(this,[e,this.getSuppressInvalidateAggregation(e,i)])};l.prototype.updateAggregation=function(e,i){var r=this.getMetadata().getAggregation(e);if(r&&r.type==="TemplateMetadataContext"){this.invalidate();return}t.prototype.updateAggregation.apply(this,arguments)};l.prototype.setVisible=function(e){this.setProperty("visible",e);if(this.getParent()){this.getParent().invalidate()}return this};l.prototype._destroyCompositeAggregation=function(){var e=this._getCompositeAggregation();if(e){e.destroy("KeepDom")}return this};l.prototype.updateBindings=function(){if(this._bIsCreating){return}var e=t.prototype.updateBindings.apply(this,arguments);for(var i in this.mBindingInfos){var r=this.getMetadata().getAggregation(i);if(r&&r.multiple&&!r._doesNotRequireFactory&&this.isBound(i)&&!this.getBinding(i)){this[r._sDestructor]()}}return e};l.prototype._getCompositeAggregation=function(){var e=this.getMetadata().getCompositeAggregationName();return this.getAggregation(e)};l.prototype._setCompositeAggregation=function(e){var t=this.getMetadata().getCompositeAggregationName();this._destroyCompositeAggregation();if(!this._oManagedObjectModel){this._getManagedObjectModel()}if(Array.isArray(e)){this.setAggregation(t,null);return}if(e){if(!e.enhanceAccessibilityState){e.enhanceAccessibilityState=function(e,t){this.enhanceAccessibilityState(e,t)}.bind(this)}e.bindObject("$"+this.alias+">/");e.setModel(this._oManagedObjectModel,"$"+this.alias);var i=this._getResourceModel();if(i){e.setModel(i,"$"+this.alias+".i18n")}}this.setAggregation(t,e)};l.mResourceModels={};l.getLibraryResourceModel=function(e){var t=l.mResourceModels[e];if(!t){t=new g({bundleName:e+".messagebundle",async:true});l.mResourceModels[e]=t}return t};l.prototype._getResourceModel=function(){if(this.resourceModel){return this.resourceModel}if(this.messageBundle){this.resourceModel=new g({bundleName:this.messageBundle,async:true});return this.resourceModel}else{this.sLibraryName=this.sLibraryName||this.getMetadata().getLibraryName();if(this.sLibraryName){return l.getLibraryResourceModel(this.sLibraryName)}}};l.prototype.getResourceBundle=function(){var e=this._getResourceModel();return e?e.getResourceBundle():null};l.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this.resourceModel){this.resourceModel.destroy()}if(this._oManagedObjectModel){this._oManagedObjectModel.destroy()}};l.prototype._initCompositeSupport=function(e){var t=this.getMetadata(),i=t._fragment,r=t.getCompositeAggregationName();this._destroyCompositeAggregation();if(e&&r&&e[r]){var o=e[r];if(o.localName==="FragmentDefinition"){i=o;delete e[r]}}this._setCompositeAggregation(sap.ui.xmlfragment({sId:this.getId(),fragmentContent:i,oController:this}));this._bIsInitialized=true};l.prototype.enhanceAccessibilityState=function(e,t){var i=this.getParent();if(i&&i.enhanceAccessibilityState){return i.enhanceAccessibilityState(this,t)}return t};l.prototype.getFocusDomRef=function(){var e=this._renderingContent?this._renderingContent():this._getCompositeAggregation();return e.getFocusDomRef()};l.prototype.getFocusInfo=function(){var e=this._renderingContent?this._renderingContent():this._getCompositeAggregation();return e.getFocusInfo()};l.prototype.getIdForLabel=function(){var e=this._renderingContent?this._renderingContent():this._getCompositeAggregation();return e.getIdForLabel()};return l});