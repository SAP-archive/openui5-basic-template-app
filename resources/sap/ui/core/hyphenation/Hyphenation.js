/*!
* OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["./HyphenationTestingWords","sap/ui/base/ManagedObject","sap/base/Log","sap/base/util/deepEqual","sap/ui/core/Locale","sap/ui/Device"],function(e,n,i,t,a,r){"use strict";var o={bg:true,ca:true,hr:true,cs:false,// no valid license
da:true,nl:true,"en-us":true,et:true,fi:true,fr:true,de:true,"el-monoton":true,hi:true,hu:true,it:true,lt:true,"nb-no":true,pl:false,// no valid license
pt:true,ru:true,sr:false,// no valid license
sl:true,es:true,sv:true,th:true,tr:true,uk:true};var u={bg:"Bulgarian",ca:"Catalan",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fi:"Finnish",fr:"French",de:"German",el:"Greek",hi:"Hindi",hu:"Hungarian",it:"Italian",lt:"Lithuanian",nb:"Norwegian Bokmål",no:"Norwegian",pl:"Polish",pt:"Portuguese",ru:"Russian",sr:"Serbian",sl:"Slovenian",es:"Spanish",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian"};var s={};var h={};var p={};var l=null;var c=null;var f={};var d={};var y=[];var g={};function v(e,n,t){i.info("[UI5 Hyphenation] Initializing third-party module for language "+C(e),"sap.ui.core.hyphenation.Hyphenation.initialize()");window.hyphenopoly.initializeLanguage(n).then(m.bind(this,e,t))}function b(e,n,t){i.info("[UI5 Hyphenation] Re-initializing third-party module for language "+C(e),"sap.ui.core.hyphenation.Hyphenation.initialize()");window.hyphenopoly.reInitializeLanguage(e,n).then(m.bind(this,e,t))}function m(e,n,i){f[e]=i;l.bIsInitialized=true;if(y.length>0){y.forEach(function(e){v(e.sLanguage,e.oConfig,e.resolve)});y=[]}l.bLoading=false;n(k(e))}function w(e,n){var t={require:[e],hyphen:"­",leftmin:3,rightmin:3,compound:"all",path:sap.ui.require.toUrl("sap/ui/thirdparty/hyphenopoly")};if(n){if("hyphen"in n){t.hyphen=n.hyphen}if("minWordLength"in n){t.minWordLength=n.minWordLength}if("exceptions"in n){i.info("[UI5 Hyphenation] Add hyphenation exceptions '"+JSON.stringify(n.exceptions)+"' for language "+C(e),"sap.ui.core.hyphenation.Hyphenation");var a=[];Object.keys(n.exceptions).forEach(function(e){a.push(n.exceptions[e])});if(a.length>0){t.exceptions={};t.exceptions[e]=a.join(", ")}}}return t}function L(e,n){return new Promise(function(i,t){var a=document.createElement("script");a.async=true;a.src=e+n;a.addEventListener("load",i);a.addEventListener("error",function(){return t("Error loading script: "+n)});a.addEventListener("abort",function(){return t(n+" Script loading aborted.")});document.head.appendChild(a)})}var H=function e(){var n=["visibility:hidden;","-moz-hyphens:auto;","-webkit-hyphens:auto;","-ms-hyphens:auto;","hyphens:auto;","width:48px;","font-size:12px;","line-height:12px;","border:none;","padding:0;","word-wrap:normal"];return n.join("")}();function z(n){if(!c){c=document.createElement("body")}var i=document.createElement("div");i.lang=n;i.id=n;i.style.cssText=H;i.appendChild(document.createTextNode(e[n.toLowerCase()]));c.appendChild(i)}function I(e){if(c){e.appendChild(c);return c}return null}function x(){if(c){c.parentNode.removeChild(c)}}function E(e){return e.style.hyphens==="auto"||e.style.webkitHyphens==="auto"||e.style.msHyphens==="auto"||e.style["-moz-hyphens"]==="auto"}function P(e){var n;if(e){n=new a(e)}else{n=sap.ui.getCore().getConfiguration().getLocale()}var i=n.getLanguage().toLowerCase();switch(i){case"en":i="en-us";break;case"nb":i="nb-no";break;case"no":i="nb-no";break;case"el":i="el-monoton";break}return i}function U(e){if(e){return new a(e).toString()}return sap.ui.getCore().getConfiguration().getLocale().toString()}function k(e){if(typeof e==="string"){return e.substring(0,2)}else{return null}}function C(e){var n=k(e);if(u.hasOwnProperty(n)){return"'"+u[n]+"' (code:'"+n+"')"}else{return"'"+n+"'"}}function O(e){l.fireError(e);i.error("[UI5 Hyphenation] "+e,"sap.ui.core.hyphenation.Hyphenation")}function S(){return!(r.os.macintosh&&r.browser.chrome)}var T=n.extend("sap.ui.core.hyphenation.Hyphenation",{metadata:{library:"sap.ui.core",events:{error:{parameters:{sErrorMessage:{type:"string"}}}}}});T.prototype.canUseNativeHyphenation=function(e){var n=U(e);var t;if(!this.isLanguageSupported(e)){return null}if(!s.hasOwnProperty(n)){z(n);var a=I(document.documentElement);if(a!==null){var r=document.getElementById(n);if(S()&&E(r)&&r.offsetHeight>12){t=true}else{t=false}x()}s[n]=t;if(t){i.info("[UI5 Hyphenation] Browser-native hyphenation can be used for language "+C(n),"sap.ui.core.hyphenation.Hyphenation.canUseNativeHyphenation()")}else{i.info("[UI5 Hyphenation] Browser-native hyphenation is not supported by current platform for language "+C(n),"sap.ui.core.hyphenation.Hyphenation.canUseNativeHyphenation()")}}else{t=s[n]}return t};T.prototype.canUseThirdPartyHyphenation=function(e){var n=P(e),t;if(!this.isLanguageSupported(e)){return null}if(!p.hasOwnProperty(n)){t=o.hasOwnProperty(n)&&o[n];if(t){i.info("[UI5 Hyphenation] Third-party hyphenation can be used for language "+C(n),"sap.ui.core.hyphenation.Hyphenation.canUseThirdPartyHyphenation()")}else{i.info("[UI5 Hyphenation] Third-party hyphenation is not supported for language "+C(n),"sap.ui.core.hyphenation.Hyphenation.canUseThirdPartyHyphenation()")}p[n]=t}else{t=p[n]}return t};T.prototype.isLanguageSupported=function(n){var t=P(n),a;if(!h.hasOwnProperty(t)){a=e.hasOwnProperty(t);if(!a){i.info("[UI5 Hyphenation] Language "+C(t)+" is not known to the Hyphenation API","sap.ui.core.hyphenation.Hyphenation.isLanguageSupported()")}h[t]=a}else{a=h[t]}return a};T.prototype.hyphenate=function(e,n){var i=P(n);if(!f.hasOwnProperty(i)){O("Language "+C(i)+" is not initialized. You have to initialize it first with method 'initialize()'");return e}return f[i](e)};T.prototype.getInitializedLanguages=function(){return Object.keys(f).map(function(e){return k(e)})};T.prototype.isLanguageInitialized=function(e){var e=P(e);return Object.keys(f).indexOf(e)!=-1};T.prototype.getExceptions=function(e){var e=P(e);if(this.isLanguageInitialized(e)){return window.hyphenopoly.languages[e].exceptions}else{O("Language "+C(e)+" is not initialized. You have to initialize it first with method 'initialize()'")}};T.prototype.addExceptions=function(e,n){var e=P(e);if(this.isLanguageInitialized(e)){i.info("[UI5 Hyphenation] Add hyphenation exceptions '"+JSON.stringify(n)+"' for language "+C(e),"sap.ui.core.hyphenation.Hyphenation.addExceptions()");Object.keys(n).forEach(function(i){window.hyphenopoly.languages[e].cache[i]=n[i];window.hyphenopoly.languages[e].exceptions[i]=n[i]})}else{O("Language "+C(e)+" is not initialized. You have to initialize it first with method 'initialize()'")}};T.prototype.initialize=function(e,n){var i=P(e);var n=w(i,n);var a=true;if(g[i]&&t(g[i],n)){a=false}g[i]=n;if(o[i]){if(!l.bIsInitialized&&!l.bLoading){l.bLoading=true;d[i]=new Promise(function(e,t){L(n.path,"/hyphenopoly.bundle.js").then(v.bind(this,i,n,e))});return d[i]}else if(l.bLoading&&!f[i]&&d[i]){return d[i]}else if(this.isLanguageInitialized(i)){if(a){d[i]=new Promise(function(e){b(i,n,e)})}}else{d[i]=new Promise(function(e,t){if(!l.bIsInitialized){y.push({sLanguage:i,oConfig:n,resolve:e})}else{v(i,n,e)}})}l.bLoading=true;return d[i]}else{var r="Language "+C(e)+" can not be initialized. It is either not supported by the third-party module or an error occurred";O(r);return new Promise(function(e,n){n(r)})}};T.getInstance=function(){if(!l){l=new T;l.bIsInitialized=false;l.bLoading=false}return l};return T});