/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/support/Plugin","sap/ui/core/support/controls/TreeViewer","sap/ui/core/support/controls/ObjectViewer","sap/ui/Device","sap/base/Log","sap/base/security/encodeXML"],function(e,t,i,n,r,o){"use strict";var a=jQuery;var s=e.extend("sap.ui.core.support.plugins.ViewInfo",{constructor:function(t){e.apply(this,["sapUiSupportViewInfo","XML View and Templating Support Tools",t]);this._oStub=t;if(!this.runsAsToolPlugin()){var i=this;sap.ui.getCore().registerPlugin({startPlugin:function(e){i.oCore=e},stopPlugin:function(){i.oCore=undefined}})}}});s.prototype.init=function(t){e.prototype.init.apply(this,arguments);if(!this.runsAsToolPlugin()){return}if(!n.browser.chrome){this.$().get(0).innerHTML="View Info Support Tool is currently only available on Chrome. We are currently working to support all browsers.";return}try{this.supportInfo=window.opener.sap.ui.core.support.Support.info}catch(e){this.$().get(0).innerHTML="View Info Support Tool needs access to the opener window. The opener window might not be accessible due to cross domain restrictions.";return}if(typeof this.supportInfo!=="function"){this.$().get(0).innerHTML="<div class='sapUISupportLabel'>"+"View Info Support Tool is only available in <b>Support Mode.</b>"+"<br>Turn it on by adding '<b>sap-ui-support=true</b>' to the url or your application."+"</div>";return}try{this.aViews=this.supportInfo.getAll("view");this.aOdataModels=this.supportInfo.getAll("datajs")}catch(e){this.$().get(0).innerHTML="View Info Support Tool raised an internal error while reading the support informations.";return}if(!this.aViews){this.$().get(0).innerHTML="View Info Support Tool did not record any information on the current page.<br>"+"Possible reasons:<br>"+"There are no XML Views defined in the current app.<br>"+"Views where not loaded before the Diagnistics tool was started."}if(this.runsAsToolPlugin()){l.call(this,t)}};function l(e){a(document).on("click",".viewxmlheader",a.proxy(this._onToggleViewInfo,this)).on("click",".viewxmlmain",a.proxy(this._onMainViewInfo,this));this.renderContentAreas()}s.prototype.exit=function(t){e.prototype.exit.apply(this,arguments);if(this.runsAsToolPlugin()){a(document).off("click",".viewxmlheader",a.proxy(this._onToggleViewInfo,this)).off("click",".viewxmlmain",a.proxy(this._onMainViewInfo,this))}};s.prototype.provideNodeInfo=function(e,t,i){if(e.env.type!=="template"){var n=this.getObjectInfo(t);var r=[];if(n){var o=this.getBreakpointInfos(n);if(o.Template){r.push(o.Template)}if(o.Attributes){r.push(o.Attributes)}if(o.Properties){r.push(o.Properties)}if(o.Methods){r.push(o.Methods)}}return r}};s.prototype.highlightTemplateTreeNode=function(e,t,i){e.clearHighlights();var n=this.getSupportInfos(t);for(var i=0;i<n.length;i++){if(n[i].context){e.expandNode(n[i].context);e.highlightNode(n[i].context)}}};s.prototype.createTree=function(e,i){var n=new t,r=this,o=e.context;n.viewDebugInfo=e;if(e.env.type==="template"){n.ignoreIds();o=e.env.clone}var a=o.querySelectorAll("*");for(var s=0;s<a.length;s++){var l=a[s],d=l.getAttribute("support:data"),p=this.supportInfo.getIds(d);if(p.length>0){if(!l.getAttribute("id")){l.setAttribute("id","")}l.setAttribute("__id",p[0])}else{l.setAttribute("__id",l.getAttribute("id"))}}n.setRootObject(o);n.attachSelectionChange(function(t){return function(i,n){if(e){if(e.env.type!=="template"){r.updateObjectInfo(i,t,n);if(e.env.templateTree){r.highlightTemplateTreeNode(e.env.templateTree,i,t)}}}}}(i));n.attachAttributeInfos(function(t,i){if(e){if(e.env.type!=="template"){if(i.name.indexOf("support:")>-1){return{visible:false}}if(i.name.indexOf("xmlns:support")>-1){return{visible:false}}}}});n.attachNodeInfos(function(t,i){return r.provideNodeInfo(e,t,i)});return n};s.prototype.renderContentAreas=function(){this._propertyChangeDebugger={};this._methodDebugger={};var e=sap.ui.getCore().createRenderManager();if(!this.aTrees){this.aTrees=[];this.aDataTrees=[];this.aObjectViewers=[];var t=0;e.write('<div class="viewxmlmain"><div class="settingscontainer"><span class="settings" raise="_onClearAllBreakpoints">Clear all breakpoints</span><span class="settings" raise="_onClearAllXMLModifications">Clear all XML modifications</span></div>');this.aMetamodels=[];if(this.aOdataModels){for(var i=0;i<this.aOdataModels.length;i++){var n=this.aOdataModels[i];if(n&&n.env.type==="metadata"){this.aMetamodels.push(n);var r=this.createTree(n,t);this.aTrees[t]=r;e.write('<div class="viewxmlheader" collapsed="true"><span class="toggle"></span><span class="info">Metadata: '+o(n.env.settings.response.requestUri)+'</span><div class="settingscontainer"><span class="settings sapUiSupportViewInfoElementHidden" raise="_onToggleDebugNodes" idx="'+t+'">Expand debugged nodes</span><span class="settings sapUiSupportViewInfoElementHidden" raise="_onToggleRealIds" idx="'+t+'"><span selected="false"></span>Show XML View Ids</span><span class="settings" raise="_onToggleNamespace" idx="'+t+'" ><span selected="false"></span>Hide tag namespace</span><span class="settings" raise="_onToggleInactive" idx="'+t+'" ><span selected="false"></span>Hide inactive</span></div></div>');e.write('<div class="sapUiSupportViewInfoElementHidden"><div id="treecontent_'+t+'"></div>');e.write('<div class="viewxmlsplitter">');e.write("</div>");e.write('<div class="viewxmlinfo"><div class="title sapUiSupportViewInfoElementHidden" id="objectHeader'+t+'">Header</div><div class="toolbar sapUiSupportViewInfoElementHidden" id="objectToolbar'+t+'">Toolbar</div><div class="content" id="selectedcontent_'+t+'">');e.write("</div></div></div>")}n.env.tree=r;t++}}if(this.aViews){for(var i=0;i<this.aViews.length;i++){var a=this.aViews[i];var r=this.createTree(a,t);this.aTrees[t]=r;this.aObjectViewers[t]=null;var s="";if(a.env.type=="template"){s=a.env.viewinfo.id}else{s=a.env.viewinfo.getId();for(var l=0;l<this.aTrees.length;l++){if(this.aTrees[l]&&this.aTrees[l].viewDebugInfo.env.type==="template"&&this.aTrees[l].viewDebugInfo.env.viewinfo.id===s){a.env.templateTree=this.aTrees[l]}}if(a.env.settings.preprocessors&&a.env.settings.preprocessors.xml&&a.env.settings.preprocessors.xml.models){var d=a.env.settings.preprocessors.xml.models;if(d){for(var p in d){if(d[p].oMetadata){var f=d[p].oMetadata.sUrl;for(var l=0;l<this.aMetamodels.length;l++){var g=this.aMetamodels[l];if(g&&g.env.settings.response.requestUri===f){if(!a.env.metamodels){a.env.metamodels=[]}a.env.metamodels.push({tree:g.env.tree,model:g,data:d[p],metamodel:d[p].oMetaModel,metadata:d[p].oMetadata})}}}}}}}if(a.env.type==="template"){e.write('<div class="viewxmlheader" collapsed="true"><span class="toggle"></span><span class="info">'+s+" ("+a.env.type+')</span><div class="settingscontainer"><span class="settings" raise="_onToggleDebugNodes" idx="'+t+'">Expand debugged nodes</span><span class="settings sapUiSupportViewInfoElementHidden" raise="_onToggleRealIds" idx="'+t+'"><span selected="false"></span>Show XML View Ids</span><span class="settings" raise="_onToggleNamespace" idx="'+t+'" ><span selected="false"></span>Hide tag namespace</span><span class="settings" raise="_onToggleInactive" idx="'+t+'" ><span selected="false"></span>Hide inactive</span></div></div>')}else{var u="";if(a.env.metamodels){u=":templated by [";for(var c=0;c<a.env.metamodels.length;c++){u+=a.env.metamodels[c].metadata.sUrl}u+="]"}var h="";if(a.env.settings.cache){h+=" from client cache "+JSON.stringify(a.env.settings.cache)}e.write('<div class="viewxmlheader" collapsed="true"><span class="toggle"></span><span class="info">'+s+" ("+a.env.type+o(String(u))+") "+o(String(h))+'</span><div class="settingscontainer"><span class="settings" raise="_onToggleDebugNodes" idx="'+t+'">Expand debugged nodes</span><span class="settings" raise="_onToggleRealIds" idx="'+t+'" ><span selected="false"></span>Show XML View Ids</span><span class="settings" raise="_onToggleNamespace" idx="'+t+'" ><span selected="false"></span>Hide tag namespace</span></div></div>')}e.write('<div class="sapUiSupportViewInfoElementHidden"><div id="treecontent_'+t+'"></div>');e.write('<div class="viewxmlsplitter">');e.write("</div>");e.write('<div class="viewxmlinfo"><div class="title sapUiSupportViewInfoElementHidden" id="objectHeader'+t+'">Header</div><div class="toolbar sapUiSupportViewInfoElementHidden" id="objectToolbar'+t+'">Toolbar</div><div class="content" id="selectedcontent_'+t+'">');e.write("</div></div></div></div>");t++}}}e.flush(this.$().get(0));if(this.aTrees){for(var t=0;t<this.aTrees.length;t++){var r=this.aTrees[t];var v=document.getElementById("treecontent_"+t);if(v){r.update(v)}}}e.destroy()};s.prototype._onClearAllBreakpoints=function(){this.supportInfo.removeAllBreakpoints()};s.prototype._onClearAllXMLModifications=function(){this.supportInfo.removeAllXMLModification()};s.prototype.getBreakpointInfos=function(e){var t={},i;function n(e){var t=0;for(var i in e){if(e[i].__enabled){t++}}return t}if(e.Template){i=n(e.Template);t["Template"]={selected:i>0,color:"orange",tooltip:"Template Breakpoints ("+i+")"}}if(e.Attributes){i=n(e.Attributes);t["Attributes"]={selected:i>0,color:"blue",tooltip:"Attribute Changes ("+i+")"}}if(e.Properties){i=n(e.Properties);t["Properties"]={selected:i>0,color:"green",tooltip:"Property Change Breakpoints ("+i+")"}}if(e.Methods){i=n(e.Methods);t["Methods"]={selected:i>0,color:"red",tooltip:"Method Breakpoints ("+i+")"}}return t};s.prototype.getSupportInfos=function(e){var t=e.getAttribute("support:data");return this.supportInfo.getInfos(t)};s.prototype.parseScalarType=function(e,t,i,n){var r=window.opener.sap.ui.base.DataType;var o=window.opener.sap.ui.base.ManagedObject;try{var a=o.bindingParser(t,n,true);if(a&&typeof a==="object"){return{binding:a}}}catch(e){return{error:"Property "+i+" - Invalid Binding:"+e.message}}var s=t=typeof a==="string"?a:t;var l=r.getType(e);if(l){if(l instanceof r){s=l.parseValue(t)}}else{return{error:"Property "+i+" has unknown type "+e}}if(!l.isValid(s)){return{error:"Property "+i+" has invalid value;"}}return{value:s}};s.prototype.getObjectInfo=function(e,t){var i=this;function n(e,t,n){return function(r){var o=i.parseScalarType(e.type,r,e.name,null);for(var a=0;a<t.length;a++){t[a].isBound(e.name);if(e.bindable){t[a][e._sUnbind](o.binding)}else{t[a].unbindProperty(e.name)}if(o.binding){if(e.bindable){t[a][e._sBind](o.binding)}else{t[a].bindProperty(e.name,o.binding)}}else if(o.value!==undefined){t[a][e._sMutator](o.value)}}n.setAttribute("__changed"+e.name,r);return o}}function r(e,n,r){return function(r){var o=i.parseScalarType(e.type,r,e.name,null);for(var a=0;a<u.length;a++){u[a].isBound(e.name);if(e.bindable){u[a][e._sUnbind](o.binding)}else{u[a].unbindProperty(e.name)}if(o.binding){if(e.bindable){u[a][e._sBind](o.binding)}else{u[a].bindProperty(e.name,o.binding)}}else if(o.value!==undefined){u[a][e._sMutator](o.value)}}if(!o.error){n.getAttribute("_index");var s=n.parentNode,l=null;while(s){l=s;s=s.parentNode}if(l){var d=l.querySelectorAll("*");for(var a=0;a<d.length;a++){if(d[a]===n){i.supportInfo.addXMLModification(t,a+1,{setAttribute:[e.name,r]});return}}}}return o}}var o=e.namespaceURI,a=e.localName,l={};var d=window.opener.jQuery.sap.getObject(o+"."+a);if(d){var p=e.getAttribute("support:data");var f=d.getMetadata().getAllProperties(),g=d.prototype,u=this.supportInfo.getElements(p),c=this.getValidDebugStackIndices(e);if(u.length>0){l.Control={};l.Control[u[0].getMetadata().getName()]={value:u[0].getId(),__highlightid:true,__readonly:true};if(u.length>1){l.Clones={};for(var h=1;h<u.length;h++){l.Clones[u[h].getMetadata().getName()+"("+h+")"]={value:u[h].getId(),__highlightid:true}}}}if(c.length>0){l.Template={};for(var h=0;h<c.length;h++){var v=c[h];l.Template[v.__infokey]={value:v.__infovalue,__idx:c[h]._idx,__enabled:this.supportInfo.hasBreakpointAt(c[h]._idx),__level:v.__level}}}var _=Object.keys(f).sort();if(e.attributes.length>0){l.Attributes={};for(var h=0;h<e.attributes.length;h++){var b=e.attributes[h];if(_.indexOf(b.name)>-1){var m=f[_[_.indexOf(b.name)]];l.Attributes[b.name]={value:b.value,__enabled:false,__docu:s.DemokitUrl+m._oParent.getName()+".html#"+m._sGetter,__original:b.value,__change:r(m,e,t),__add:true}}}}if(_.length>0){l.Properties={};for(var h=0;h<_.length;h++){var m=f[_[h]];var y={value:e.getAttribute("__changed"+m.name)||e.getAttribute(_[h]),value2:u[0]&&u[0][m._sGetter]?u[0]&&u[0][m._sGetter]():null,__controls:u,__enabled:u[0]&&this._propertyChangeDebugger[u[0].getId()+"__"+_[h]]!=null,__docu:s.DemokitUrl+m._oParent.getName()+".html#"+m._sGetter,__original:e.getAttribute(_[h]),__changed:null};y.__change=n(m,u,e);l.Properties[_[h]]=y}}var I=Object.keys(g).sort();if(I.length>0){l.Methods={};for(var h=0;h<I.length;h++){l.Methods[I[h]]={value:"",__controls:u,__enabled:u[0]&&this._methodDebugger[u[0].getId()+"__"+I[h]]!=null}}}}return l};s.prototype._makePropFn=function(e){return function(t){if(t.getParameter("name")===e){debugger}}};s.prototype._makeFn=function(e){return function(){debugger;return e.apply(this,arguments)}};s.prototype.highlightControl=function(e,t,i){try{if(this._highlightControl){this._highlightControl.control.getDomRef().style.outline=this._highlightControl.outline}if(this._highlightControls){for(var n=0;n<this._highlightControls.length;n++){this._highlightControls[n].control.getDomRef().style.outline=this._highlightControls[n].outline}}this._highlightControl=null;this._highlightControls=[];if(e.Control&&e.Control[Object.keys(e.Control)[0]].__highlightid){if(t==="Control"&&e.Clones){for(var o in e.Clones){var a=opener.sap.ui.getCore().byId(e.Clones[o].value);if(a&&a.getDomRef()){this._highlightControls.push({control:a,outline:a.getDomRef().style.outline});a.getDomRef().style.outline="solid 1px orange"}}}else{if(!i){i=e.Control[Object.keys(e.Control)[0]]}if(t==="Control"&&i){var s=opener.sap.ui.getCore().byId(i.value);if(s&&s.getDomRef()){this._highlightControl={control:s,outline:s.getDomRef().style.outline};if(s.getDomRef()){s.getDomRef().style.outline="solid 1px orange"}}}}if(t==="Clones"){var s=opener.sap.ui.getCore().byId(i.value);if(s&&s.getDomRef()){this._highlightControl={control:s,outline:s.getDomRef().style.outline};if(s.getDomRef()){s.getDomRef().style.outline="solid 1px orange"}}}}}catch(e){r.debug("Diagnostics: ViewInfo failed to remove highlighting of controls")}};s.DemokitUrl="https://sapui5.hana.ondemand.com/#docs/api/symbols/";s.prototype.updateObjectInfo=function(e,t,n){var r=this.aObjectViewers[t],o=this;if(!r){r=new i;this.aObjectViewers[t]=r}var a=document.getElementById("objectHeader"+t);a.style.display="none";var l=this.aTrees[t];r.initialExpandedSections=this.oObjectViewer?this.oObjectViewer.expandedSections:[];var d=this.getObjectInfo(e,l.viewDebugInfo.env.viewinfo.getId());var p="";try{if(!d.Control&&e.parentNode){var f=e.parentNode.namespaceURI+"."+e.parentNode.localName;var g="get"+e.localName.substring(0,1).toUpperCase()+e.localName.substring(1);p+='<a target="_docu" href="'+s.DemokitUrl+f+'.html">'+f+"</a> ("+e.tagName+") ";p+=': <a target="_docu" href="'+s.DemokitUrl+f+".html#"+g+'">'+e.localName+" aggregation</a>"}else{var f=e.namespaceURI+"."+e.localName;p+='<a target="_docu" href="'+s.DemokitUrl+f+'.html">'+f+"</a> ("+e.tagName+") ";var u=window.opener.jQuery.sap.getObject(Object.keys(d.Control)[0]).getMetadata().getParent().getName();p+=': <a target="_docu" href="'+s.DemokitUrl+u+'.html">'+u+"</a>"}}catch(e){p+=""}a.style.display="block";a.innerHTML=p;o.highlightControl(d,"Control");r.setRootObject(d);r.attachObjectInfos(function(e,t,i,n){if(t==="Template"){if(d[t][n].__enabled){return[{selected:true,color:"orange",tooltip:"Disable breakpoint"}]}else{return[{selected:false,color:"orange",tooltip:"Break if resolved after reload/reprocess"}]}}else if(t==="Attributes"){if(d[t][n].__enabled){return[{selected:true,color:"blue",tooltip:"Disable breakpoint"}]}else{return[{selected:false,color:"blue",tooltip:"Break if changed"}]}}else if(t==="Properties"){if(d[t][n].__enabled){return[{selected:true,color:"green",tooltip:"Disable breakpoint"}]}else{return[{selected:false,color:"green",tooltip:"Break if changed"}]}}else if(t==="Methods"){if(d[t][n].__enabled){return[{selected:true,color:"red",tooltip:"Disable breakpoint"}]}else{return[{selected:false,color:"red",tooltip:"Break if called"}]}}return[]});r.attachSelect(function(e){if(e&&e.__docu){window.open(e.__docu,"_docu")}});r.attachHover(function(e,t,i){o.highlightControl(d,t,e)});r.attachInfoPress(function(e,t,i){var n=d[e][t].__idx,a=d[e][t].__enabled;if(!a){if(e==="Template"){o.supportInfo.addBreakpointAt(n)}else if(e==="Properties"){var s=d[e][t].__controls;if(s){for(var p=0;p<s.length;p++){var f=s[p];o._propertyChangeDebugger[f.getId()+"__"+t]=o.supportInfo._breakAtProperty(t);f.attachEvent("_change",o._propertyChangeDebugger[f.getId()+"__"+t])}}}else if(e==="Methods"){var s=d[e][t].__controls;if(s){for(var p=0;p<s.length;p++){var f=s[p];var g=f[t];o._methodDebugger[f.getId()+"__"+t+"__fn"]=g;o._methodDebugger[f.getId()+"__"+t]=o.supportInfo._breakAtMethod(g);f[t]=o._methodDebugger[f.getId()+"__"+t]}}}d[e][t].__enabled=true;r.setInfoSelected(e,t,i,true)}else{if(e==="Template"){o.supportInfo.removeBreakpointAt(n)}else if(e==="Properties"){var s=d[e][t].__controls;if(s){for(var p=0;p<s.length;p++){var f=s[p];f.detachEvent("_change",o._propertyChangeDebugger[f.getId()+"__"+t]);delete o._propertyChangeDebugger[f.getId()+"__"+t]}}}else if(e==="Methods"){var s=d[e][t].__controls;if(s){for(var p=0;p<s.length;p++){var f=s[p];f[t]=o._methodDebugger[f.getId()+"__"+t+"__fn"];delete o._methodDebugger[f.getId()+"__"+t];delete o._methodDebugger[f.getId()+"__"+t+"__fn"]}}}d[e][t].__enabled=false;r.setInfoSelected(e,t,i,false)}if(d){var u=o.getBreakpointInfos(d);var p=0;if(u.Template){l.setInfoSelected(l.getSelectedIndex(),p++,u.Template.selected,u.Template.tooltip)}if(u.Attributes){l.setInfoSelected(l.getSelectedIndex(),p++,u.Attributes.selected,u.Attributes.tooltip)}if(u.Properties){l.setInfoSelected(l.getSelectedIndex(),p++,u.Properties.selected,u.Properties.tooltip)}if(u.Methods){l.setInfoSelected(l.getSelectedIndex(),p,u.Methods.selected,u.Methods.tooltip)}}});var c=document.getElementById("selectedcontent_"+t);if(c){r.update(c)}this.oObjectViewer=r};s.prototype._onToggleRealIds=function(e){var t=e.target;if(t.getAttribute("selected")){t=t.parentNode}var i=parseInt(t.getAttribute("idx")),n=this.aTrees[i];if(n.toggleIds()){t.innerHTML='<span selected="false"></span>Show XML View Ids'}else{t.innerHTML='<span selected="true"></span>Show Real Ids'}};s.prototype._onToggleInactive=function(e){var t=e.target;if(t.getAttribute("selected")){t=t.parentNode}var i=parseInt(t.getAttribute("idx")),n=this.aTrees[i];if(n.toggleInactive()){t.innerHTML='<span selected="false"></span>Hide inactive'}else{t.innerHTML='<span selected="true"></span>Show inactive'}e.stopPropagation()};s.prototype._onToggleNamespace=function(e){var t=e.target;if(t.getAttribute("selected")){t=t.parentNode}var i=parseInt(t.getAttribute("idx")),n=this.aTrees[i];if(n.toggleNS()){t.innerHTML='<span selected="false"></span>Hide tag namespace'}else{t.innerHTML='<span selected="true"></span>Show tag namespace'}e.stopPropagation()};s.prototype._onToggleDebugNodes=function(e){var t=parseInt(e.target.getAttribute("idx")),i=this.aTrees[t];i.expandNodesWithSelectedInfo(0);i.expandNodesWithSelectedInfo(1);i.expandNodesWithSelectedInfo(2)};s.prototype.resizeHandler=function(){var e=document.querySelectorAll(".viewxmlheader");for(var t=0;t<e.length;t++){var i=e[t];var n=i.getAttribute("collapsed")==="true";if(!n){var r=i.offsetWidth-30;var o=i.nextSibling.firstChild.offsetHeight;i._iOldWidth=r;i._iOldHeight=o;i.nextSibling.firstChild.style.width=r/3*2+"px";i.nextSibling.lastChild.style.width=r/3+"px";i.nextSibling.lastChild.style.height=o+"px";i.nextSibling.lastChild.style.marginTop=-o+"px";i.nextSibling.lastChild.style.marginLeft=r/3*2+20+"px";i.nextSibling.lastChild.lastChild.height=o-50+"px";i.nextSibling.lastChild.lastChild.width="100%"}}if(!this.iInterval){var a=this;this.iInterval=window.setInterval(function(){var e=document.querySelectorAll(".viewxmlheader");var t=e[0];for(var i=0;i<e.length;i++){var t=e[i];var n=t.getAttribute("collapsed")==="true";if(!n){if(t._iOldWidth!==t.offsetWidth-30||t._iOldHeight!==t.nextSibling.firstChild.offsetHeight){a.resizeHandler()}}}},100)}};s.prototype._onMainViewInfo=function(e){var t=e.target,i=t.getAttribute("raise");if(i&&this[i]){this[i](e);e.stopPropagation();return}};s.prototype._onToggleViewInfo=function(e){var t=e.target,i=t.getAttribute("raise");if(i&&this[i]){this[i](e);e.stopPropagation();return}i=t.parentNode.getAttribute("raise");if(i&&this[i]){this[i](e);e.stopPropagation();return}if(!t.getAttribute("collapsed")){t=t.parentNode}var n=t.getAttribute("collapsed")==="true";if(n){t.setAttribute("collapsed","false");t.nextSibling.style.display="block";this.resizeHandler()}else{t.setAttribute("collapsed","true");t.nextSibling.style.display="none"}};s.prototype.getValidDebugStackIndices=function(e){var t=[],i=e.getAttribute("support:data"),n=["xmlns","support:data"];if(i){var r=i.split(","),o=this.supportInfo,a=0;for(var s=0;s<r.length;s++){var l=parseInt(r[s]);var d=o.byIndex(l);if(!d){continue}d.__debugging=o.hasBreakpointAt(l);if(d.env){if(d.env.caller==="visitAttributes"){for(var p in d.env){if(p==="caller"||p==="info"){continue}var f=true;for(var g=0;g<n.length;g++){if(d.env[p].name.indexOf(n[g])===0){f=false;break}}if(f){if(p.indexOf("after")===0){a--}d.__infokey=p+":"+d.env[p].name;d.__level=a;d.__infovalue=d.env[p].value;if(p.indexOf("before")===0){a++}t.push(d)}}}else if(d.env.caller==="getMetadata"){for(var p in d.env){if(p==="caller"||p==="info"){continue}var f=true;for(var g=0;g<n.length;g++){if(d.env[p].name.indexOf(n[g])===0){f=false;break}}if(f){if(p.indexOf("after")===0){a--}d.__infokey=p+":"+d.env[p].name;d.__level=a;d.__infovalue=d.env[p].value;t.push(d);if(p.indexOf("before")===0){a++}}}}else if(d.env.caller==="getProperty"){for(var p in d.env){if(p==="caller"||p==="info"){continue}var f=true;for(var g=0;g<n.length;g++){if(d.env[p].name.indexOf(n[g])===0){f=false;break}}if(f){if(p.indexOf("after")===0){a--}d.__infokey=p+":"+d.env[p].name;d.__level=a;d.__infovalue=d.env[p].value;t.push(d);if(p.indexOf("before")===0){a++}}}}else if(d.env.caller==="visitNode"){for(var p in d.env){if(p.indexOf("after")===0){a--}d.__infokey=p+":Node";d.__infovalue=d.env[p].name;t.push(d);if(p.indexOf("before")===0){a++}}}}}}return t};return s});