/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define([],function(){"use strict";var e={grandTotal:"boolean",max:"boolean",min:"boolean",name:"string",subtotals:"boolean",with:"string"},r={aggregate:"object",group:"object",groupLevels:"array"},t;function n(e,r,t){var n;function o(e){if(t){e+=" at property: "+t}throw new Error(e)}function i(e){return Array.isArray(e)?"array":typeof e}for(n in e){if(!(r&&n in r)){o("Unsupported '"+n+"'")}else if(i(e[n])!==r[n]){o("Not a "+r[n]+" value for '"+n+"'")}}}function o(e,r){var t;for(t in e){n(e[t],r,t)}}t={buildApply:function(t,i,a,u){var g,f="",s=[],l,p,c;function d(e){var r=t.aggregate[e],n=r.name||e,o=e,a=r.with;if(a){if((a==="average"||a==="countdistinct")&&(r.grandTotal||r.subtotals)){throw new Error("Cannot aggregate totals with '"+a+"'")}n+=" with "+a+" as "+e}else if(r.name){n+=" as "+e}if(!u){if(r.min){$(e,"min")}if(r.max){$(e,"max")}}if(r.grandTotal){p=true;if(!i.$skip){if(a){o+=" with "+a+" as UI5grand__"+e}s.push(o)}}return n}function h(e){return t.groupLevels.indexOf(e)<0}function $(e,r){var t="UI5"+r+"__"+e;s.push(e+" with "+r+" as "+t);if(a){a[t]={measure:e,method:r}}}function v(){var e="";if(i.$skip){e="skip("+i.$skip+")"}delete i.$skip;if(i.$top<Infinity){if(e){e+="/"}e+="top("+i.$top+")"}delete i.$top;return e}i=jQuery.extend({},i);n(t,r);t.groupLevels=t.groupLevels||[];if(t.groupLevels.length>1){throw new Error("More than one group level: "+t.groupLevels)}t.aggregate=t.aggregate||{};o(t.aggregate,e);g=Object.keys(t.aggregate).sort().map(d);if(p&&t.groupLevels.length){throw new Error("Cannot combine visual grouping with grand total")}if(g.length){f="aggregate("+g.join(",")+")"}t.group=t.group||{};o(t.group);l=t.groupLevels.concat(Object.keys(t.group).sort().filter(h));if(l.length){f="groupby(("+l.join(",")+(f?"),"+f+")":"))")}if(u){delete i.$count}else if(i.$count){s.push("$count as UI5__count");delete i.$count}if(i.$filter){f+="/filter("+i.$filter+")";delete i.$filter}if(i.$orderby){f+="/orderby("+i.$orderby+")";delete i.$orderby}if(p){if(i.$skip){i.$skip-=1}else{i.$top-=1}}c=v();if(s.length){f+="/concat(aggregate("+s.join(",")+"),"+(c||"identity")+")"}else if(c){f+="/"+c}i.$apply=f;return i},hasGrandTotal:function(e){return!!e&&Object.keys(e).some(function(r){return e[r].grandTotal})},hasMinOrMax:function(e){return!!e&&Object.keys(e).some(function(r){var t=e[r];return t.min||t.max})}};return t},false);