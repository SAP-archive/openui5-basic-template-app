/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/extend","sap/ui/core/format/DateFormat","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/model/odata/type/ODataType"],function(t,e,n,a,i,o,r){"use strict";var s=(new Date).getFullYear(),l=new Date(Date.UTC(s,11,31)),u=new Date(s,11,31,23,59,58);function f(t){return t.oConstraints&&t.oConstraints.isDateOnly}function c(t){return sap.ui.getCore().getLibraryResourceBundle().getText(f(t)?"EnterDate":"EnterDateTime",[t.formatValue(f(t)?l:u,"string")])}function p(t){var a;if(!t.oFormat){a=e({strictParsing:true},t.oFormatOptions);if(f(t)){a.UTC=true;t.oFormat=n.getDateInstance(a)}else{t.oFormat=n.getDateTimeInstance(a)}}return t.oFormat}function h(e,n){var a,i;e.oConstraints=undefined;if(n){a=n.nullable;if(a===false||a==="false"){e.oConstraints={nullable:false}}else if(a!==undefined&&a!==true&&a!=="true"){t.warning("Illegal nullable: "+a,null,e.getName())}if(n.isDateOnly===true){e.oConstraints=e.oConstraints||{};e.oConstraints.isDateOnly=true}i=n.precision;if(i!==undefined){if(i===Math.floor(i)&&i>=1&&i<=12){e.oConstraints=e.oConstraints||{};e.oConstraints.precision=i}else if(i!==0){t.warning("Illegal precision: "+i,null,e.getName())}}}e._handleLocalizationChange()}var m=r.extend("sap.ui.model.odata.type.DateTimeBase",{constructor:function(t,e){r.apply(this,arguments);h(this,e);this.oFormat=null;this.oFormatOptions=t},metadata:{abstract:true}});m.prototype.formatValue=function(t,e){if(t===null||t===undefined){return null}switch(this.getPrimitiveType(e)){case"any":case"object":return t;case"string":if(!(t instanceof Date)){throw new a("Illegal "+this.getName()+" value: "+t)}return p(this).format(t);default:throw new a("Don't know how to format "+this.getName()+" to "+e)}};m.prototype.parseValue=function(t,e){var n;if(t===null||t===""){return null}switch(this.getPrimitiveType(e)){case"object":return t;case"string":n=p(this).parse(t);if(!n){throw new i(c(this))}return n;default:throw new i("Don't know how to parse "+this.getName()+" from "+e)}};m.prototype._handleLocalizationChange=function(){this.oFormat=null};m.prototype.validateValue=function(t){if(t===null){if(this.oConstraints&&this.oConstraints.nullable===false){throw new o(c(this))}return}else if(t instanceof Date){if(t.getFullYear()===0){throw new o(c(this))}return}throw new o("Illegal "+this.getName()+" value: "+t)};return m});