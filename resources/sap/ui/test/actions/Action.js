/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/qunit/QUnitUtils","sap/ui/test/Opa5","sap/ui/Device","sap/base/Log","sap/ui/thirdparty/jquery"],function(e,t,s,i,n,r){"use strict";return e.extend("sap.ui.test.actions.Action",{metadata:{properties:{idSuffix:{type:"string"}},publicMethods:["executeOn"]},executeOn:function(){return true},$:function(e){var t,s=this._getAdapter(e.getMetadata()),i=this.getIdSuffix()||s;if(i){t=e.$(i)}else{t=r(e.getFocusDomRef())}if(!t.length){var o="Control "+e+" has no dom representation idSuffix was "+i;n.error(o,this._sLogPrefix);throw new Error(o)}else{n.info("Found a domref for the Control "+e+" the action is going to be executed on the dom id"+t[0].id,this._sLogPrefix)}return t},getUtils:function(){return s.getUtils()||t},init:function(){this.controlAdapters={}},_getAdapter:function(e){var t=this.controlAdapters[e.getName()];if(t){return t}var s=e.getParent();if(s){return this._getAdapter(s)}return null},_tryOrSimulateFocusin:function(e,t){var s=e.is(":focus");var r;var o=e[0];if(s||i.browser.msie&&i.browser.version<12||i.browser.firefox&&i.browser.version>60){r=true}else{e.focus();var a=e.is(":focus");r=!a}if(r){n.debug("Control "+t+" could not be focused - maybe you are debugging?",this._sLogPrefix);this._createAndDispatchFocusEvent("focusin",o);this._createAndDispatchFocusEvent("focus",o);this._createAndDispatchFocusEvent("activate",o)}},_simulateFocusout:function(e){this._createAndDispatchFocusEvent("focusout",e);this._createAndDispatchFocusEvent("blur",e);this._createAndDispatchFocusEvent("deactivate",e)},_createAndDispatchMouseEvent:function(e,t){var s=0;var n;if(i.browser.phantomJS||i.browser.msie&&i.browser.version<12){n=document.createEvent("MouseEvent");n.initMouseEvent(e,true,true,window,0,0,0,0,0,false,false,false,false,s,t)}else{n=new MouseEvent(e,{bubbles:true,cancelable:true,identifier:1,target:t,radiusX:1,radiusY:1,rotationAngle:0,button:s,type:e})}t.dispatchEvent(n)},_createAndDispatchFocusEvent:function(e,t){var s;if(i.browser.phantomJS){s=document.createEvent("FocusEvent");s.initEvent(e,true,false)}else if(i.browser.msie&&i.browser.version<12){s=document.createEvent("FocusEvent");s.initFocusEvent(e,true,false,window,0,t)}else{s=new FocusEvent(e)}t.dispatchEvent(s);n.info("Dispatched focus event: '"+e+"'",this._sLogPrefix)},_sLogPrefix:"sap.ui.test.actions"})});