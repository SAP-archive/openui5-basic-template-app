/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/UriParameters","./_utils"],function(n,t){"use strict";function i(n){return Array.isArray(n)?n:[n]}function e(n){return new Promise(function(t,e){sap.ui.require(i(n),function(){t(Array.prototype.slice.call(arguments))},e)})}function r(n,t,i){if(t){for(var e in t){if(Object.prototype.hasOwnProperty.call(i,e)){n[e]=t[e]}}}return n}function o(){function n(n){if(document.body.querySelector("#"+n)==null){var t=document.createElement("div");t.id=n;document.body.insertBefore(t,document.body.firstChild)}}return t.whenDOMReady().then(function(){n("qunit");n("qunit-fixture")})}function u(n){var t=n.sourceFile+":"+n.lineNumber+":"+n.columnNumber,i="Security policy violation: directive '"+n.violatedDirective+"'";if(n.blockedURI){i+=" violated by '"+String(n.blockedURI).slice(0,20)+"'"}if(QUnit.config.current){QUnit.pushFailure(i,t)}else{throw new Error(i+" at "+t)}}var s={altertitle:1,collapse:1,filter:1,fixture:1,hidepassed:1,maxDepth:1,module:1,moduleId:1,notrycatch:1,noglobals:1,seed:1,reorder:1,requireExpects:1,testId:1,testTimeout:1,scrolltop:1};function a(n){var i,a,c,f,l,p,d,h,v,y;document.title=n.title;if(n.loader){sap.ui.loader.config(n.loader)}if(n.runAfterLoader){i=e(n.runAfterLoader)}else{i=Promise.resolve()}if(n.qunit.version==="edge"||n.qunit.version===true){n.qunit.version=2}if(typeof n.qunit.version==="number"){if(n.qunit.version===1){h="sap/ui/thirdparty/qunit";v="sap/ui/thirdparty/qunit.css"}else if(n.qunit.version===2){h="sap/ui/thirdparty/qunit-2";v="sap/ui/thirdparty/qunit-2.css"}else{throw new TypeError("unsupported qunit version "+n.qunit.version)}window.QUnit=window.QUnit||{};QUnit.config=QUnit.config||{};if(n.qunit!=null&&typeof n.qunit==="object"){r(QUnit.config,n.qunit,s)}QUnit.config.autostart=false;a=i.then(function(){return e("sap/ui/test/qunitPause")}).then(function(){t.addStylesheet(v);return e(h)}).then(function(){y=[];QUnit.jUnitDone=function(n){y.push(n)};return e("sap/ui/qunit/qunit-junit")}).then(function(){delete QUnit.jUnitDone;return e("sap/ui/thirdparty/qunit-reporter-junit")}).then(function(){y.forEach(function(n){QUnit.jUnitDone(n)});y=undefined})}if(n.sinon.version==="edge"||n.sinon.version===true){n.sinon.version=4}if(typeof n.sinon.version==="number"){var g,m;if(n.sinon.version===1){g="sap/ui/thirdparty/sinon";m="sap/ui/thirdparty/sinon-qunit"}else if(n.sinon.version===4){g="sap/ui/thirdparty/sinon-4";m="sap/ui/qunit/sinon-qunit-bridge"}else{throw new TypeError("unsupported sinon version "+n.sinon.version)}c=i.then(function(){return e(g)});if(n.sinon.qunitBridge&&a){f=Promise.all([a,c]).then(function(){return e(m)})}if(n.sinon!=null&&typeof n.sinon==="object"){l=Promise.all([c,f]).then(function(){sinon.config=r(sinon.config||{},n.sinon,sinon.defaultConfig);return arguments})}}else if(h){sap.ui.loader.config({shim:{"sap/ui/thirdparty/sinon-qunit":{deps:[h,"sap/ui/thirdparty/sinon"]},"sap/ui/qunit/sinon-qunit-bridge":{deps:[h,"sap/ui/thirdparty/sinon-4"]}}})}p=a.then(function(){if(QUnit.urlParams.coverage){return e("sap/ui/thirdparty/blanket").then(function(){if(n.coverage&&window.blanket){if(n.coverage.only!=null){window.blanket.options("sap-ui-cover-only",n.coverage.only)}if(n.coverage.never!=null){window.blanket.options("sap-ui-cover-never",n.coverage.never)}if(n.coverage.branchTracking){window.blanket.options("branchTracking",true)}}return e("sap/ui/qunit/qunit-coverage")}).then(function(){QUnit.config.autostart=false})}else{return e(["sap/ui/qunit/qunit-coverage"])}}).then(function(){if(QUnit.urlParams["sap-ui-xx-csp-policy"]){document.addEventListener("securitypolicyviolation",u);QUnit.done(function(){document.removeEventListener("securitypolicyviolation",u)})}QUnit.config.urlConfig.push({id:"sap-ui-xx-csp-policy",label:"CSP",value:{"sap-target-level-1:report-only":"Level 1","sap-target-level-2:report-only":"Level 2"},tooltip:"What Content-Security-Policy should the server send"})});d=Promise.all([i,a,c,f,l,p]);if(n.beforeBootstrap){d=d.then(function(){return e(n.beforeBootstrap)})}window["sap-ui-config"]=n.ui5||{};if(Array.isArray(window["sap-ui-config"].libs)){window["sap-ui-config"].libs=window["sap-ui-config"].libs.join(",")}if(n.bootCore){d=d.then(function(){return new Promise(function(n,t){sap.ui.require(["sap/ui/core/Core"],function(t){t.boot();t.attachInit(n)},t)})})}return d.then(function(){if(n.autostart){return e(n.module).then(function(n){return Promise.all(n)}).then(function(){return o()}).then(function(){if(n.ui5["xx-waitfortheme"]==="init"){return new Promise(function(n,t){sap.ui.require(["sap/ui/qunit/utils/waitForThemeApplied"],n,t)}).then(function(n){return n()})}}).then(function(){QUnit.start()})}else{return o().then(function(){return e(n.module).then(function(n){return Promise.all(n)})})}})}var c=n.fromQuery(window.location.search),f=t.getAttribute("data-sap-ui-testsuite")||c.get("testsuite"),l=t.getAttribute("data-sap-ui-test")||c.get("test");t.getSuiteConfig(f).then(function(n){var t=n.tests[l];if(!t){throw new TypeError("Invalid test name")}return a(t)}).catch(function(n){console.error(n.stack||n);if(typeof QUnit!=="undefined"){QUnit.test("Test Starter",function(){throw n});QUnit.start()}else{t.whenDOMReady().then(function(){document.body.innerHTML="<pre style='color:red;'>"+t.encode(n.stack||n.message||String(n))+"</pre>"})}})});