/*!
 * OpenUI5
 * (c) Copyright 2009-2020 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Renderer","./YearPicker","./YearRangePickerRenderer","./CalendarDate","sap/ui/core/date/UniversalDate","./CalendarUtils","sap/ui/thirdparty/jquery"],function(e,t,a,r,i,s,n){"use strict";var o=t.extend("sap.ui.unified.calendar.YearRangePicker",{metadata:{library:"sap.ui.unified",properties:{years:{type:"int",group:"Appearance",defaultValue:9},columns:{type:"int",group:"Appearance",defaultValue:3},rangeSize:{type:"int",group:"Appearance",defaultValue:20}}}});o.prototype.setDate=function(e){var t,a,i,n;e&&s._checkJSDateObject(e);a=e.getFullYear();s._checkYearInValidRange(a);t=r.fromLocalJSDate(e,this.getPrimaryCalendarType());t.setMonth(0,1);this.setProperty("date",e,true);this.setProperty("year",t.getYear(),true);this._oDate=t;if(this.getDomRef()){i=this.getYears();n=new r(this._oDate,this.getPrimaryCalendarType());n.setYear(n.getYear()-Math.floor(i/2)*this.getRangeSize());n=this._checkFirstDate(n);this._updateYears(n,Math.floor(i/2))}return this};o.prototype._checkFirstDate=function(e){var t=this.getYears();var a=new r(this._oMaxDate,this.getPrimaryCalendarType());a.setYear(a.getYear()-t*this.getRangeSize()+1);if(e.isAfter(a)&&e.getYear()!=a.getYear()){e=new r(a,this.getPrimaryCalendarType());e.setMonth(0,1)}else if(e.isBefore(this._oMinDate)&&e.getYear()!=this._oMinDate.getYear()){e=new r(this._oMinDate,this.getPrimaryCalendarType());e.setMonth(0,1)}return e};o.prototype._updatePage=function(e,t,a){var i=this._oItemNavigation.getItemDomRefs(),s=r.fromLocalJSDate(this._oFormatYyyymmdd.parse(n(i[0]).attr("data-sap-year-start")),this.getPrimaryCalendarType()),o=this.getYears();if(e){var h=new r(this._oMaxDate,this.getPrimaryCalendarType());h.setYear(h.getYear()-o*this.getRangeSize()+1);if(s.isBefore(h)){s.setYear(s.getYear()+o*this.getRangeSize());s=this._checkFirstDate(s)}else{return}}else{if(s.isAfter(this._oMinDate)){s.setYear(s.getYear()-o*this.getRangeSize());if(s.isBefore(this._oMinDate)){s=new r(this._oMinDate,this.getPrimaryCalendarType())}s=this._checkFirstDate(s)}else{return}}this._updateYears(s,t);if(a){this.firePageChange()}};o.prototype._checkDateEnabled=function(e,t){if(s._isBetween(this._oMinDate,e,t,true)||s._isBetween(this._oMaxDate,e,t,true)||this._oMinDate.isBefore(e)&&this._oMaxDate.isAfter(t)){return true}return false};o.prototype._updateYears=function(e,t){var a=new r(this._getDate(),this.getPrimaryCalendarType()),o="",h="",g=new r(e,this.getPrimaryCalendarType()),p=this._oItemNavigation.getItemDomRefs(),l,y;a.setYear(a.getYear()+Math.floor(this.getRangeSize()/2));g.setYear(g.getYear()+this.getRangeSize()-1);for(var u=0;u<p.length;u++){l=this._oFormatYyyymmdd.format(e.toUTCJSDate(),true);y=n(p[u]);y.attr("id",this.getId()+"-y"+l);o=this._oYearFormat.format(i.getInstance(e.toUTCJSDate(),e.getCalendarType()),true);h=this._oYearFormat.format(i.getInstance(g.toUTCJSDate(),g.getCalendarType()),true);y.text(o+" - "+h);y.attr("data-sap-year-start",l);if(s._isBetween(a,e,g,true)){t=u}if(this._checkDateEnabled(e,g)){y.removeClass("sapUiCalItemDsbl");y.removeAttr("aria-disabled")}else{y.addClass("sapUiCalItemDsbl");y.attr("aria-disabled",true)}e.setYear(g.getYear()+1);g.setYear(g.getYear()+this.getRangeSize())}this._oItemNavigation.focusItem(t)};o.prototype._selectYear=function(e){var t=this._oItemNavigation.getItemDomRefs(),a=n(t[e]),i=a.attr("data-sap-year-start"),s=r.fromLocalJSDate(this._oFormatYyyymmdd.parse(i),this.getPrimaryCalendarType());if(a.hasClass("sapUiCalItemDsbl")){return false}this.setProperty("date",s.toLocalJSDate(),true);this.setProperty("year",s.getYear(),true);return true};return o});