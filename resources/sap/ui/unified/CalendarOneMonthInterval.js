/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/unified/calendar/CustomMonthPicker","sap/ui/unified/calendar/CalendarUtils","sap/ui/unified/calendar/CalendarDate","sap/ui/unified/Calendar","./library","sap/ui/unified/CalendarDateInterval","sap/ui/unified/calendar/OneMonthDatesRow","sap/ui/unified/DateRange","./CalendarOneMonthIntervalRenderer"],function(t,e,a,o,n,i,r,s,h){"use strict";var g=i.extend("sap.ui.unified.CalendarOneMonthInterval",{});g.prototype.init=function(){i.prototype.init.apply(this,arguments);this._bShowOneMonth=true};g.prototype._getCalendar=function(){var a;if(!this._oCalendar){a=new t(this.getId()+"--Cal");a.setPopupMode(true);a.attachEvent("select",function(){var t=this._getCalendar(),a=t._getFocusedDate(),o=e._getFirstDateOfMonth(a);var n=this.getAggregation("month")[0];this._setStartDate(o);if(n.getMode()<2){o=this._getStartDate()}this._adjustSelectedDate(o);this._oFocusDateOneMonth=o;this._closeCalendarPicker(true);this._focusDate(a,false,true)},this);a.attachEvent("cancel",function(t){var e=this._getCalendar(),a=e._getFocusedDate();this._closeCalendarPicker(true);this._oFocusDateOneMonth=a;this._focusDate(a,true);var o=this.getAggregation("header").getDomRef("B1");if(o){o.focus()}},this);this._oCalendar=a}return this._oCalendar};g.prototype._createMonth=function(t){return new r(t)};g.prototype._handleFocus=function(t){var o=!!t.getParameter("_outsideBorder"),n=t.getParameter("date"),r=a.fromLocalJSDate(n),s=a.fromLocalJSDate(this.getStartDate()),h=!e._isSameMonthAndYear(r,s),g,u,l;if(o||h){if(e._isLastDateInMonth(r)){this._oFocusDateOneMonth=r}else{this._oFocusDateOneMonth=e._getFirstDateOfMonth(r)}g=r.isBefore(s)?-1:1;u=new a(this._getFocusedDate(),this.getPrimaryCalendarType());l=new a(this._getStartDate(),this.getPrimaryCalendarType());i.prototype._shiftStartFocusDates.call(this,u,l,g)}return i.prototype._handleFocus.apply(this,arguments)};g.prototype._focusDateExtend=function(t,e,a){var o,n;if(!this._oFocusDateOneMonth){return i.prototype._focusDateExtend.apply(this,arguments)}o=this.getAggregation("month")[0];n=this._oFocusDateOneMonth.toLocalJSDate();this._setFocusedDate(this._oFocusDateOneMonth);o._bNoRangeCheck=true;o.setDate(n);o._bNoRangeCheck=false;this._oFocusDateOneMonth=null;return!a};g.prototype._setDisplayMode=function(t){this.getAggregation("month")[0].setMode(t)};g.prototype._shiftStartFocusDates=function(t,e,o){var n=o,i=this.getAggregation("month")[0],r,s;if(n!==0){n=n>0?1:-1}t.setMonth(t.getMonth()+n);e.setYear(t.getYear());e.setMonth(t.getMonth(),t.getDate());this._setFocusedDate(e);this._setStartDate(t,true);r=this.getStartDate();s=a.fromLocalJSDate(r,this.getPrimaryCalendarType());if(this.getMinDate()&&this.getMinDate().getTime()>r.getTime()){s=a.fromLocalJSDate(this.getMinDate(),this.getPrimaryCalendarType())}if(this.getMaxDate()&&this.getMaxDate().getTime()<r.getTime()){s=a.fromLocalJSDate(this.getMaxDate(),this.getPrimaryCalendarType())}i.selectDate(s.toLocalJSDate());if(i.getMode()<2){this.fireSelect()}};g.prototype._adjustSelectedDate=function(t){var e=this.getAggregation("month")[0];if(e.getMode&&e.getMode()<2){this._selectDate(t)}};g.prototype._selectDate=function(t){var e=this.getAggregation("month")[0],a=t.toLocalJSDate();this.removeAllSelectedDates();this.addSelectedDate(new s({startDate:a}));e.selectDate(a);this._bDateRangeChanged=undefined};g.prototype._dateMatchesVisibleRange=function(t){return e._isSameMonthAndYear(a.fromLocalJSDate(this.getStartDate()),a.fromLocalJSDate(t))};g.prototype._togglePrevNext=function(t,o){var n=this.getAggregation("header");var i=this._oMaxDate.getYear();var r=this._oMinDate.getYear();var s=this._oMaxDate.getMonth();var h=this._oMinDate.getMonth();var g=e._getFirstDateOfMonth(t);var u=new a(g),l,c;u.setMonth(u.getMonth()+1);l=g.getYear();c=g.getMonth();if(l<r||l==r&&(!o||c<=h)){n.setEnabledPrevious(false)}else{n.setEnabledPrevious(true)}l=u.getYear();c=u.getMonth();if(l>i||l==i&&(!o||c>s)){n.setEnabledNext(false)}else{n.setEnabledNext(true)}};g.prototype._setMinMaxDateExtend=function(t){return o.prototype._setMinMaxDateExtend.apply(this,arguments)};return g});