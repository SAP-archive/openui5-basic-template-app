/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/InvisibleText","sap/ui/core/library","sap/ui/Device","sap/ui/base/ManagedObject","./ObjectIdentifierRenderer"],function(t,e,i,o,s,r,n,a){"use strict";var l=s.TextDirection;var p=e.extend("sap.m.ObjectIdentifier",{metadata:{library:"sap.m",designtime:"sap/m/designtime/ObjectIdentifier.designtime",properties:{title:{type:"string",group:"Misc",defaultValue:null},text:{type:"string",group:"Misc",defaultValue:null},badgeNotes:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},badgePeople:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},badgeAttachments:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},visible:{type:"boolean",group:"Appearance",defaultValue:true},titleActive:{type:"boolean",group:"Misc",defaultValue:false},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:l.Inherit}},aggregations:{_titleControl:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_textControl:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},events:{titlePress:{parameters:{domRef:{type:"object"}}}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},dnd:{draggable:true,droppable:false}}});p.prototype.init=function(){var t=sap.ui.getCore().getLibraryResourceBundle("sap.m");if(sap.ui.getCore().getConfiguration().getAccessibility()){p.OI_ARIA_ROLE=t.getText("OI_ARIA_ROLE");this._createAriaInfoTextControl()}};p.prototype.exit=function(){if(this._attachmentsIcon){this._attachmentsIcon.destroy();this._attachmentsIcon=null}if(this._peopleIcon){this._peopleIcon.destroy();this._peopleIcon=null}if(this._notesIcon){this._notesIcon.destroy();this._notesIcon=null}if(this._oAriaCustomRole){this._oAriaCustomRole.destroy();this._oAriaCustomRole=null}};p.prototype._getAttachmentsIcon=function(){if(!this._attachmentsIcon){this._attachmentsIcon=this._getIcon(i.getIconURI("attachment"),this.getId()+"-attachments")}return this._attachmentsIcon};p.prototype._getPeopleIcon=function(){if(!this._peopleIcon){this._peopleIcon=this._getIcon(i.getIconURI("group"),this.getId()+"-people")}return this._peopleIcon};p.prototype._getNotesIcon=function(){if(!this._notesIcon){this._notesIcon=this._getIcon(i.getIconURI("notes"),this.getId()+"-notes")}return this._notesIcon};p.prototype._getIcon=function(t,e){var o=r.system.phone?"1em":"1em";var s;s=this._icon||i.createControlByURI({src:t,id:e+"-icon",size:o,useIconTooltip:false},sap.m.Image);s.setSrc(t);return s};p.prototype._getTitleControl=function(){var t=this.getAggregation("_titleControl"),e=this.getId();if(!t){if(this.getProperty("titleActive")){t=new sap.m.Link({id:e+"-link",text:n.escapeSettingsValue(this.getProperty("title")),ariaLabelledBy:this._oAriaCustomRole});t.addAssociation("ariaLabelledBy",e+"-text",true)}else{t=new sap.m.Text({id:e+"-txt",text:n.escapeSettingsValue(this.getProperty("title"))})}this.setAggregation("_titleControl",t,true)}t.setVisible(!!this.getTitle());return t};p.prototype._updateTitleControl=function(t){var e,i=this._getTitleControl(),o=this.getId();if(t&&i instanceof sap.m.Text){this.destroyAggregation("_titleControl",true);i=new sap.m.Link({id:o+"-link",text:n.escapeSettingsValue(this.getProperty("title")),ariaLabelledBy:this._oAriaCustomRole});i.addAssociation("ariaLabelledBy",o+"-text",true);this.setAggregation("_titleControl",i,true)}else if(!t&&i instanceof sap.m.Link){this.destroyAggregation("_titleControl",true);i=new sap.m.Text({id:o+"-txt",text:n.escapeSettingsValue(this.getProperty("title"))});this.setAggregation("_titleControl",i,true)}if(this.$("title").length){i.setProperty("text",this.getProperty("title"),true);e=sap.ui.getCore().createRenderManager();e.renderControl(i);e.flush(this.$("title")[0]);e.destroy()}return i};p.prototype._getTextControl=function(){var t=this.getAggregation("_textControl");if(!t){t=new sap.m.Text({text:n.escapeSettingsValue(this.getProperty("text"))});this.setAggregation("_textControl",t,true)}t.setTextDirection(this.getTextDirection());t.setVisible(!!this.getText());return t};p.prototype.setTitle=function(t){var e=this._getTitleControl(),i;e.setProperty("text",t,false);e.setVisible(!!e.getText());this.setProperty("title",t,true);i=this.$().find(".sapMObjectIdentifierTopRow");if(this._hasTopRow()){i.attr("style",null)}else{i.css("display","none")}this.$("text").toggleClass("sapMObjectIdentifierTextBellow",!!this.getProperty("text")&&!!this.getProperty("title"));return this};p.prototype.setText=function(t){this.setProperty("text",t,true);var e=this._getTextControl();e.setProperty("text",t,false);this.$("text").toggleClass("sapMObjectIdentifierTextBellow",!!this.getProperty("text")&&!!this.getProperty("title"));return this};p.prototype.setTitleActive=function(t){var e=this.getProperty("titleActive");if(e!=t){this.setProperty("titleActive",t,true);this._updateTitleControl(t)}return this};p.prototype._handlePress=function(t){var e=t.target;if(this.getTitleActive()&&this.$("title")[0].firstChild==e){this.fireTitlePress({domRef:e});t.setMarked()}};p.prototype.onsapenter=function(t){p.prototype._handlePress.apply(this,arguments)};p.prototype.onsapspace=function(t){p.prototype._handlePress.apply(this,arguments)};p.prototype.ontap=function(t){p.prototype._handlePress.apply(this,arguments)};p.prototype.addAssociation=function(t,i,o){var s=this.getAggregation("_titleControl");if(t==="ariaLabelledBy"){if(this.getTitleActive()&&s instanceof sap.m.Link){s.addAssociation("ariaLabelledBy",i,true)}}return e.prototype.addAssociation.apply(this,arguments)};p.prototype.removeAssociation=function(t,i,o){var s=this.getAggregation("_titleControl");if(t==="ariaLabelledBy"){if(this.getTitleActive()&&s instanceof sap.m.Link){s.removeAssociation("ariaLabelledBy",i,true)}}return e.prototype.removeAssociation.apply(this,arguments)};p.prototype._createAriaInfoTextControl=function(){if(!this._oAriaCustomRole){this._oAriaCustomRole=new o(this.getId()+"-oIHiddenText",{text:p.OI_ARIA_ROLE})}return this._oAriaCustomRole};p.prototype.getAccessibilityInfo=function(){var t=this.getAggregation("_titleControl").getAccessibilityInfo(),e=(p.OI_ARIA_ROLE+" "+(t.type||"")).trim();t.type=e;t.description=t.description+" "+this.getText();return t};p.prototype._hasTopRow=function(){return this.getTitle()||this.getBadgeNotes()||this.getBadgePeople()||this.getBadgeAttachments()};return p});