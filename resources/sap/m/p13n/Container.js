/*
 * ! OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/AbstractContainer","sap/m/Bar","sap/m/Button","sap/m/List","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/p13n/AbstractContainerItem","sap/ui/Device","sap/m/library","sap/m/StandardListItem"],function(t,i,e,a,s,n,o,r,h,p){"use strict";var d=h.ButtonType;var _=h.ListType;var l=t.extend("sap.m.p13n.Container",{metadata:{library:"sap.m",properties:{listLayout:{type:"Boolean",defaultValue:false}}},renderer:{apiVersion:2}});l.prototype.DEFAULT_KEY="$default";l.prototype.init=function(){t.prototype.init.apply(this,arguments);this.addStyleClass("sapMP13nContainer");this.setListLayout(r.system.phone)};l.prototype.setListLayout=function(t){this.setProperty("listLayout",t);this._getTabBar().removeAllItems();this._getNavigationList().removeAllItems();var e;if(t){this._getTabBar().setVisible(false);this._getNavigationList();this.switchView(this.DEFAULT_KEY);e=this._getNavBackBtn()}else{this._getTabBar().setVisible(true);var a=this.getViews();if(a.length>1){this.switchView(a[1].getKey())}e=this._getTabBar()}var s=this.getHeader();if(!s){var n=new i({contentLeft:[e]});this.setHeader(n)}else{s.removeAllContentLeft();s.addContentLeft(e)}this.getViews().forEach(function(t){this._addToNavigator(t)}.bind(this));return this};l.prototype.switchView=function(i){t.prototype.switchView.apply(this,arguments);var e=this.getParent();if(e&&e.isA("sap.ui.core.Control")){e.focus();e.invalidate()}this.oLayout.setShowHeader(i!==this.DEFAULT_KEY);this._getTabBar().setSelectedKey(i);this._getNavBackBtn().setVisible(i!==this.DEFAULT_KEY);this._getNavBackBtn().setText(i)};l.prototype.addView=function(i){t.prototype.addView.apply(this,arguments);this._addToNavigator(i);return this};l.prototype._getTabBar=function(){if(!this._oTabBar){this._oTabBar=new s({expandable:false,expanded:true,select:function(t){this.switchView(t.getParameter("key"))}.bind(this)});this.addDependent(this._oTabBar)}return this._oTabBar};l.prototype._getNavigationList=function(){if(!this._oNavigationList){this._oNavigationList=new a({itemPress:function(t){var i=t.getParameter("listItem");this.switchView(i._key)}.bind(this)}).addStyleClass("p13nContainerDefaultList");this.addDependent(this._oNavigationList)}if(!this.getView(this.DEFAULT_KEY)){var t=new o({key:this.DEFAULT_KEY,content:this._oNavigationList});this.addView(t)}return this._oNavigationList};l.prototype._getNavBackBtn=function(){if(!this._oNavBackBtn){this._oNavBackBtn=new e({type:d.Back,press:function(t){this.switchView(this.DEFAULT_KEY)}.bind(this)});this.addDependent(this._oNavBackBtn)}return this._oNavBackBtn};l.prototype._addToNavigator=function(t){var i=t.getKey(),e=t.getText(),a=t.getIcon();if(i==this.DEFAULT_KEY){return}if(this.getListLayout()){this.getView(this.DEFAULT_KEY);var s=new p({type:_.Navigation,icon:a,title:e});s._key=i;this._getNavigationList().addItem(s)}else{this._getTabBar().addItem(new n({key:i,text:e||i}))}};l.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._oTabBar){this._oTabBar.destroy();this._oTabBar=null}if(this._oNavigationList){this._oNavigationList.destroy();this._oNavigationList=null}this._oNavBackBtn=null};return l});