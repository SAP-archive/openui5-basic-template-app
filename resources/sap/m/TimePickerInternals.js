/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/library","sap/ui/core/Control","sap/ui/model/type/Date","sap/ui/model/odata/type/ODataType","sap/ui/core/format/DateFormat","sap/ui/core/LocaleData","sap/ui/core/Locale","./TimePickerInternalsRenderer"],function(t,e,r,o,a,i,s,n){"use strict";var u=1,p=t.CalendarType;var l=e.extend("sap.m.TimePickerInternals",{metadata:{library:"sap.m",properties:{localeId:{type:"string",group:"Data"},displayFormat:{name:"displayFormat",type:"string",group:"Appearance"},minutesStep:{type:"int",group:"Misc",defaultValue:u},secondsStep:{type:"int",group:"Misc",defaultValue:u},value:{type:"string",group:"Data",defaultValue:null},valueFormat:{type:"string",group:"Data",defaultValue:null},support2400:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{_buttonAmPm:{type:"sap.m.SegmentedButton",multiple:false,visibility:"hidden"}}}});l.prototype.init=function(){var t=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale(),e=i.getInstance(t),r=e.getDayPeriods("abbreviated"),o=e.getTimePattern("medium");this._oResourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._sAM=r[0];this._sPM=r[1];this._kbdBuffer="";this.setDisplayFormat(o);this._setTimeValues();this._sMinutes;this._sSeconds;this._clickAttached;this._setAriaLabel(this._oResourceBundle.getText("TIMEPICKER_CLOCK_DIAL_LABEL"));this._setAriaRoleDescription(this._oResourceBundle.getText("TIMEPICKER_INPUTS_ROLE_DESCRIPTION"))};l.prototype.exit=function(){this._destroyControls();this.destroyAggregation("_texts")};l.prototype.setDisplayFormat=function(t){this.setProperty("displayFormat",t,true);this._destroyControls();this._createControls();return this};l.prototype.setLocaleId=function(t){var e,r;t=this.validateProperty("localeId",t);this.setProperty("localeId",t,true);if(t){e=new s(t);r=i.getInstance(e).getDayPeriods("abbreviated");this._sAM=r[0];this._sPM=r[1];this._destroyControls();this._createControls()}return this};l.prototype.setSupport2400=function(t){this.setProperty("support2400",t,true);this._destroyControls();this._createControls();return this};l.prototype.setMinutesStep=function(t){this.setProperty("minutesStep",t,true);this._destroyControls();this._createControls();return this};l.prototype.setSecondsStep=function(t){this.setProperty("secondsStep",t,true);this._destroyControls();this._createControls();return this};l.prototype._destroyControls=function(){};l.prototype._createControls=function(){};l.prototype._setTimeValues=function(t,e){};l.prototype._checkStyle=function(t){return t==="short"||t==="medium"||t==="long"||t==="full"};l.prototype._getDisplayFormatPattern=function(){var t=this.getDisplayFormat();if(this._checkStyle(t)){t=this._getLocaleBasedPattern(t)}return t};l.prototype._getValueFormatPattern=function(){var t=this._getBoundValueTypePattern()||this.getValueFormat()||"medium";if(this._checkStyle(t)){t=this._getLocaleBasedPattern(t)}return t};l.prototype._getLocaleBasedPattern=function(t){return i.getInstance(sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale()).getTimePattern(t)};l.prototype._getFormatButton=function(){return this.getAggregation("_buttonAmPm")};l.prototype._parseValue=function(t){return this._getFormatter().parse(t)};l.prototype._getFormatter=function(){var t=this._getBoundValueTypePattern(),e=false,r=this.getBinding("value"),o;if(r&&r.oType&&r.oType.oOutputFormat){e=!!r.oType.oOutputFormat.oFormatOptions.relative;o=r.oType.oOutputFormat.oFormatOptions.calendarType}if(!t){t=this.getValueFormat()||"medium";o=p.Gregorian}if(!o){o=sap.ui.getCore().getConfiguration().getCalendarType()}return this._getFormatterInstance(t,e,o)};l.prototype._getBoundValueTypePattern=function(){var t=this.getBinding("value"),e=t&&t.getType&&t.getType();if(e instanceof r){return e.getOutputPattern()}if(e instanceof o&&e.oFormat){return e.oFormat.oFormatOptions.pattern}return undefined};l.prototype._getFormatterInstance=function(t,e,r,o){var a;if(this._checkStyle(t)){a=this._getFormatInstance({style:t,strictParsing:true,relative:e,calendarType:r})}else{a=this._getFormatInstance({pattern:t,strictParsing:true,relative:e,calendarType:r})}return a};l.prototype._getFormatInstance=function(t,e){return a.getTimeInstance(t)};l.prototype._formatValue=function(t){if(t){return this._getFormatter().format(t)}return""};l.prototype._getTimeSeparators=function(t){var e=sap.ui.core.format.DateFormat.getInstance({pattern:t}).aFormatArray,r=[],o,a;for(a=0;a<e.length;a++){if(e[a].type!=="text"){if(o){r.push("")}else{o=true}}else{r.push(e[a].value);o=false}}return r};l.prototype._isFormatSupport24=function(){var t=this._getDisplayFormatPattern();return t.indexOf("HH")!==-1||t.indexOf("H")!==-1};l.prototype._formatNumberToString=function(t,e,r,o){var a;if(e&&t<10){a="0"+t}else if(t===r&&o!==""){a=o}else{a=t.toString()}return a};l.prototype._setAriaLabel=function(t){this._sAriaLabel=t;return this};l.prototype._getAriaLabel=function(){return this._sAriaLabel};l.prototype._setAriaRoleDescription=function(t){this._sAriaRoleDescription=t;return this};l.prototype._getAriaRoleDescription=function(){return this._sAriaRoleDescription};l._replaceZeroHoursWith24=function(t,e,r){var o=2,a=e;if(e===-1){o=1;a=r}return t.substr(0,a)+"24"+t.substr(a+o)};l._replace24HoursWithZero=function(t,e,r){var o=2,a=e;if(e===-1){o=1;a=r}return t.substr(0,a)+c(0,o)+t.substr(a+2)};l._isHoursValue24=function(t,e,r){if(e===-1&&r===-1){return false}var o=e;if(e===-1){o=r}return t.substr(o,2)==="24"};function c(t,e){var r="";for(var o=0;o<e;o++){r+=t}return r}return l});