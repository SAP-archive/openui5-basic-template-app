/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/library","sap/ui/core/IconPool","sap/ui/core/theming/Parameters","sap/ui/Device","./library","./ListItemBase","./Image","./StandardListItemRenderer"],function(e,t,i,n,o,a,s,r){"use strict";var p=e.TextDirection;var l=e.ValueState;var u=a.extend("sap.m.StandardListItem",{metadata:{library:"sap.m",properties:{title:{type:"string",group:"Misc",defaultValue:null},description:{type:"string",group:"Misc",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},iconInset:{type:"boolean",group:"Appearance",defaultValue:true},iconDensityAware:{type:"boolean",group:"Misc",defaultValue:true},activeIcon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},info:{type:"string",group:"Misc",defaultValue:null},infoState:{type:"sap.ui.core.ValueState",group:"Misc",defaultValue:l.None},adaptTitleSize:{type:"boolean",group:"Appearance",defaultValue:true},titleTextDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:p.Inherit},infoTextDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:p.Inherit},wrapping:{type:"boolean",group:"Behavior",defaultValue:false},infoStateInverted:{type:"boolean",group:"Appearance",defaultValue:false}},designtime:"sap/m/designtime/StandardListItem.designtime"}});u.prototype.exit=function(){if(this._oImage){this._oImage.destroy("KeepDom")}a.prototype.exit.apply(this,arguments)};u.prototype.setIcon=function(e){var i=this.getIcon();this.setProperty("icon",e);if(this._oImage&&(!e||t.isIconURI(e)!=t.isIconURI(i))){this._oImage.destroy("KeepDom");this._oImage=undefined}return this};u.prototype._getImage=function(){var e=this._oImage;if(e){e.setSrc(this.getIcon());if(e.setDensityAware){e.setDensityAware(this.getIconDensityAware())}}else{e=t.createControlByURI({id:this.getId()+"-img",src:this.getIcon(),densityAware:this.getIconDensityAware(),useIconTooltip:false},s).setParent(this,null,true)}var i=this.getIconInset()?"sapMSLIImg":"sapMSLIImgNoInset";e.addStyleClass(e instanceof s?i:i+"Icon",true);this._oImage=e;return this._oImage};u.prototype._activeHandlingInheritor=function(){if(this._oImage){var e=this.getActiveIcon();e&&this._oImage.setSrc(e)}};u.prototype._inactiveHandlingInheritor=function(){if(this._oImage){this._oImage.setSrc(this.getIcon())}};u.prototype.getContentAnnouncement=function(e){var t=this.getInfoState(),i=this.getTitle(),n,o=this.getDescription(),a,s,r,p=[],l=this.getInfo();if(this.getWrapping()){s=this.getDomRef("titleButton");r=this.getDomRef("descriptionButton");i=this._bTitleTextExpanded?i:this._getCollapsedText(i);o=this._bDescriptionTextExpanded?o:this._getCollapsedText(o);p.push(i);if(s){n=s.textContent+" "+e.getText("ACC_CTR_TYPE_BUTTON");n&&p.push(n)}p.push(o);if(r){a=r.textContent+" . "+e.getText("ACC_CTR_TYPE_BUTTON");a&&p.push(a)}}else{i&&p.push(i);o&&p.push(o)}l&&p.push(l);if(t!="None"&&t!=this.getHighlight()){p.push(e.getText("LIST_ITEM_STATE_"+t.toUpperCase()))}return p.join(" . ").trim()};u.prototype._measureInfoTextWidth=function(e){if(!u._themeInfo){u._themeInfo={}}if(!u._themeInfo.sFontFamily||e){u._themeInfo.sFontFamily=i.get("sapUiFontFamily")}if(!u._themeInfo.sFontStyleInfoStateInverted||e){u._themeInfo.sFontStyleInfoStateInverted="bold "+parseFloat(i.get("sapMFontSmallSize"))*16+"px"+" "+u._themeInfo.sFontFamily}if(!u._themeInfo.sFontStyle||e){u._themeInfo.sFontStyle=parseFloat(i.get("sapMFontMediumSize"))*16+"px"+" "+u._themeInfo.sFontFamily}if(!u._themeInfo.iBaseFontSize||e){u._themeInfo.iBaseFontSize=parseInt(o.BaseFontSize)||16}if(!u._oCanvas){u._oCanvas=document.createElement("canvas");u._oCtx=u._oCanvas.getContext("2d")}if(this.getInfoStateInverted()){u._oCtx.font=u._themeInfo.sFontStyleInfoStateInverted||""}else{u._oCtx.font=u._themeInfo.sFontStyle||""}return Math.ceil(u._oCtx.measureText(this.getInfo()).width)/u._themeInfo.iBaseFontSize};u.prototype._getInfoTextMinWidth=function(e){if(this.getInfoStateInverted()&&e<=7.5){return e+.625+"rem"}if(e<=7.5){return e+"rem"}return"7.5rem"};u.prototype.ontap=function(e){this._checkExpandCollapse(e);if(!e.isMarked()){return a.prototype.ontap.apply(this,arguments)}};u.prototype.onsapspace=function(e){this._checkExpandCollapse(e,true);if(!e.isMarked()){return a.prototype.onsapspace.apply(this,arguments)}};u.prototype._checkExpandCollapse=function(e,t){var i=e.target,n=i&&i.id;if(n&&n===this.getId()+"-titleButton"){if(t){e.preventDefault()}e.setMarked();return this._toggleExpandCollapse("title",this._bTitleTextExpanded)}if(n&&n===this.getId()+"-descriptionButton"){if(t){e.preventDefault()}e.setMarked();return this._toggleExpandCollapse("description",this._bDescriptionTextExpanded)}};u.prototype._toggleExpandCollapse=function(e,t){var i=this.getDomRef(e+"Text"),n=this.getDomRef(e+"ThreeDots"),o=this.getDomRef(e+"Button"),a=e==="title"?this.getTitle():this.getDescription(),s=sap.ui.getCore().getLibraryResourceBundle("sap.m");if(!t){i.textContent=a;n.textContent=" ";o.textContent=s.getText("TEXT_SHOW_LESS");t=true}else{i.textContent=this._getCollapsedText(a);n.textContent=" ... ";o.textContent=s.getText("TEXT_SHOW_MORE");t=false}if(e==="title"){this._bTitleTextExpanded=t}else{this._bDescriptionTextExpanded=t}};u.prototype._getCollapsedText=function(e){var t=n.system.phone?100:300;return e.substr(0,t)};u.prototype.onThemeChanged=function(e){a.prototype.onThemeChanged.apply(this,arguments);var t=e.theme;if(!this._initialRender){this._initialRender=true;if(!u._themeInfo){u._themeInfo={}}if(!u._themeInfo.sCurrentTheme){u._themeInfo.sCurrentTheme=t}return}var i=this.getDomRef("info");if(i){var n;if(u._themeInfo.sCurrentTheme!==t){u._themeInfo.sCurrentTheme=t;n=this._measureInfoTextWidth(true)}else{n=this._measureInfoTextWidth()}i.style.minWidth=this._getInfoTextMinWidth(n)}};return u});