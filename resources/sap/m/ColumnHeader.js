/*
 * ! UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/core/Icon","./ColumnHeaderRenderer"],function(t,e,i){"use strict";var r=t.extend("sap.m.ColumnHeader",{library:"sap.m",metadata:{properties:{text:{type:"string",defaultValue:null},sorted:{type:"boolean",defaultValue:false},sortOrder:{type:"string",defaultValue:null},filtered:{type:"boolean",defaultValue:false}},defaultAggregations:"viewSettingsPopover",aggregations:{viewSettingsPopover:{type:"sap.m.ViewSettingsPopover",multiple:false},_sortIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},_filterIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"}}}});r.prototype.setViewSettingsPopover=function(t){this.setAggregation("viewSettingsPopover",t,true);this._attachViewSettingsPopoverEvents();return this};r.prototype.setSortOrder=function(t){this.setProperty("sortOrder",t);var i=t==="Ascending"?"sap-icon://sort-ascending":"sap-icon://sort-descending";var r=this.getAggregation("_sortIcon");if(!r){this.setAggregation("_sortIcon",new e({src:i,visible:this.getSorted()}))}else{r.setSrc(i)}return this};r.prototype.setSorted=function(t){this.setProperty("sorted",t);var i=this.getAggregation("_sortIcon");if(!t&&!i){return this}if(t){if(!i){this.setAggregation("_sortIcon",new e({src:this.getSortOrder()==="Ascending"?"sap-icon://sort-ascending":"sap-icon://sort-descending"}))}else{i.setVisible(true)}}else{i.setVisible(false)}return this};r.prototype.setFiltered=function(t){this.setProperty("filtered",t);var i=this.getAggregation("_filterIcon");if(!t&&!i){return this}if(t){if(!i){this.setAggregation("_filterIcon",new e({src:"sap-icon://filter"}))}else{i.setVisible(true)}}else{i.setVisible(false)}return this};r.prototype.setTableAdapter=function(t){this._oAdapter=t};r.prototype.getTableAdapter=function(){return this._oAdapter||{interactive:true,rowAggregation:"items"}};r.prototype.onclick=function(t){if(this._isInteractive()){this._openColumnActions()}};r.prototype.onsapselect=r.prototype.onclick;r.prototype._openColumnActions=function(){var t=this.getViewSettingsPopover();if(t!=null){var e=this.$();t.openBy(this);t._getPopover(this).setOffsetY(-e.outerHeight())}};r.prototype._attachViewSettingsPopoverEvents=function(){var t=this.getViewSettingsPopover();if(t){this._detachViewSettingsPopoverEvents(t);t.attachSortSelected(this.onSortSelected,this);t.attachFilterSelected(this.onFilterSelected,this)}};r.prototype._detachViewSettingsPopoverEvents=function(t){t.detachSortSelected(this.onSortSelected,this);t.detachFilterSelected(this.onFilterSelected,this)};r.prototype.onSortSelected=function(){if(!this.getSorted()){this.setSorted(true)}if(this.getSortOrder()===""||this.getSortOrder()==="Descending"){this.setSortOrder("Ascending")}else{this.setSortOrder("Descending")}};r.prototype.onFilterSelected=function(){this.setFiltered(true)};r.prototype.getAccessibilityInfo=function(){var t=sap.ui.getCore().getLibraryResourceBundle("sap.m"),e=this.getText()+" ";if(this._isInteractive()){if(this.getSortOrder()){e+=t.getText("COLUMNHEADER_SORTED")+" ";e+=(this.getSortOrder()==="Ascending"?t.getText("COLUMNHEADER_SORTED_ASCENDING"):t.getText("COLUMNHEADER_SORTED_DESCENDING"))+" "}if(this.getFiltered()){e+=t.getText("COLUMNHEADER_FILTERED")+" "}e+=t.getText("COLUMNHEADER_ACCESS_COLUMN_ACTIONS");return{role:"button",focusable:true,description:e}}return{focusable:false,description:e}};r.prototype._isInteractive=function(){return this.getTableAdapter().interactive&&!!this.getViewSettingsPopover()};r.prototype.exit=function(){this._oAdapter=null};return r});