/*!
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Core","sap/ui/core/Element","sap/ui/Device","./ListItemBase","./Button","./ToolbarSeparator","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/ui/core/IconPool","sap/ui/core/Icon","sap/ui/core/library"],function(t,e,o,r,n,i,s,a,l,u,p,f){"use strict";var g=f.Priority;var h=t.ButtonType;var c=t.OverflowToolbarPriority;var y=e.getLibraryResourceBundle("sap.m"),v=y.getText("NOTIFICATION_LIST_ITEM_CLOSE"),d=y.getText("NOTIFICATION_LIST_GROUP_CLOSE");var w=n.extend("sap.m.NotificationListBase",{metadata:{library:"sap.m",abstract:true,properties:{priority:{type:"sap.ui.core.Priority",group:"Appearance",defaultValue:g.None},title:{type:"string",group:"Appearance",defaultValue:""},datetime:{type:"string",group:"Appearance",defaultValue:""},showButtons:{type:"boolean",group:"Behavior",defaultValue:true},showCloseButton:{type:"boolean",group:"Behavior",defaultValue:true},authorName:{type:"string",group:"Appearance",defaultValue:""},authorPicture:{type:"sap.ui.core.URI"}},aggregations:{buttons:{type:"sap.m.Button",multiple:true},_closeButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_overflowToolbar:{type:"sap.m.OverflowToolbar",multiple:false,visibility:"hidden"},_priorityIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"}},events:{close:{}}},renderer:null});w.prototype._activeHandling=function(){};w.prototype.updateSelectedDOM=function(){};w.prototype.getAccessibilityText=function(){return""};w.prototype.getButtons=function(){var t=this._getCloseButton(),e=this._getToolbarSeparator();return this._getOverflowToolbar().getContent().filter(function(o){return o!==t&&o!==e},this)};w.prototype.addButton=function(t){var e=this._getOverflowToolbar(),o=e.getContent().length;if(r.system.phone){o-=2}e.insertContent(t,o);this.invalidate();return this};w.prototype.insertButton=function(t,e){this._getOverflowToolbar().insertContent(t,e);this.invalidate();return this};w.prototype.removeButton=function(t){var e=this._getOverflowToolbar().removeContent(t.getId());this.invalidate();return e};w.prototype.removeAllButtons=function(){var t=this._getOverflowToolbar(),e=this.getButtons();e.forEach(function(e){t.removeContent(e.getId())});this.invalidate();return this};w.prototype.destroyButtons=function(){var t=this.getButtons();t.forEach(function(t){t.destroy()});this.invalidate();return this};w.prototype.clone=function(){var t=n.prototype.clone.apply(this,arguments);t.destroyAggregation("_overflowToolbar");var e=this.getAggregation("_overflowToolbar");if(e){t.setAggregation("_overflowToolbar",e.clone(),true)}return t};w.prototype._getOverflowToolbar=function(){var t=this.getAggregation("_overflowToolbar"),e,o;if(!t){t=new a(this.getId()+"-overflowToolbar",{});this.setAggregation("_overflowToolbar",t,true);if(r.system.phone){o=this._getCloseButton();o.setLayoutData(new l({priority:c.AlwaysOverflow}));e=new s;e.setLayoutData(new l({priority:c.AlwaysOverflow}));t.addContent(e);t.addContent(o)}}return t};w.prototype._getCloseButton=function(){var t,e,o,n;if(r.system.phone){e=this._getOverflowToolbar();o=e.getContent();if(e&&o.length){n=o.length-1;t=o[n]}}else{t=this.getAggregation("_closeButton")}if(!t){if(r.system.phone){t=new i(this.getId()+"-closeButtonOverflow",{text:this.isA("sap.m.NotificationListItem")?v:d,type:h.Default,press:function(){this.close()}.bind(this)})}else{t=new i(this.getId()+"-closeButtonX",{icon:u.getIconURI("decline"),type:h.Transparent,tooltip:this.isA("sap.m.NotificationListItem")?v:d,press:function(){this.close()}.bind(this)});this.setAggregation("_closeButton",t)}}return t};w.prototype._getToolbarSeparator=function(){if(!r.system.phone){return null}var t,e=this._getOverflowToolbar(),o=e.getContent(),n;if(e&&o.length){n=o.length-2;t=o[n]}return t};w.prototype.exit=function(){};w.prototype._hasActionButtons=function(){return this.getShowButtons()&&this.getButtons().length};w.prototype._shouldRenderCloseButton=function(){return!r.system.phone&&this.getShowCloseButton()};w.prototype._shouldRenderOverflowToolbar=function(){var t=this._hasActionButtons();if(r.system.phone){return t||this.getShowCloseButton()}return t};w.prototype.onBeforeRendering=function(){var t=this.getButtons(),e,o;if(r.system.phone){this._updatePhoneButtons();return}e=t.length>1?c.AlwaysOverflow:c.NeverOverflow;for(var n=0;n<t.length;n++){o=t[n];o.setLayoutData(new l({priority:n===0?e:c.AlwaysOverflow}))}};w.prototype._updatePhoneButtons=function(){var t=this._getCloseButton(),e=this.isA("sap.m.NotificationListGroup"),o=e?d:v,r=e&&this.getCollapsed(),n=!r&&this._hasActionButtons(),i=this.getShowCloseButton(),s=this._getToolbarSeparator(),a;this.getButtons().forEach(function(t){if(n){a=c.AlwaysOverflow;t.removeStyleClass("sapMNLIBHiddenButton")}else{a=c.NeverOverflow;t.addStyleClass("sapMNLIBHiddenButton")}t.setLayoutData(new l({priority:a}))});if(!i){t.setVisible(false);s.setVisible(false);return}t.setVisible(true);if(n){t.setText(o);t.setTooltip("");t.setType(h.Default);t.setIcon("");t.setLayoutData(new l({priority:c.AlwaysOverflow}));s.setVisible(true)}else{t.setText("");t.setTooltip(o);t.setType(h.Transparent);t.setIcon(u.getIconURI("decline"));t.setLayoutData(new l({priority:c.NeverOverflow}));s.setVisible(false)}};w.prototype.close=function(){var t=this.getParent();this.fireClose();var e=!!this.getParent();if(!e&&t&&t instanceof o){var r={onAfterRendering:function(){t.focus();t.removeEventDelegate(r)}};t.addEventDelegate(r)}};w.prototype._getPriorityIcon=function(){var t=this.getAggregation("_priorityIcon");if(!t){t=new p({src:"sap-icon://message-error",useIconTooltip:false});this.setAggregation("_priorityIcon",t,true)}return t};return w});